% This is samplepaper.tex, a sample chapter demonstrating the
% LLNCS macro package for Springer Computer Science proceedings;
% Version 2.21 of 2022/01/12
%
\documentclass[runningheads]{llncs}
%
% \usepackage{hyperref}

\usepackage[T1]{fontenc}
% T1 fonts will be used to generate the final print and online PDFs,
% so please use T1 fonts in your manuscript whenever possible.
% Other font encondings may result in incorrect characters.
%
\usepackage[titletoc]{appendix}
\usepackage{graphicx}
% \usepackage{quiver}
\usepackage{proof}
\usepackage{amsmath,amssymb,amsfonts}
% \usepackage{amsmath,amsfonts,MnSymbol}
% \usepackage{MnSymbol}

% \usepackage{tikz-cd}
% \usepackage{float}
% % \tikzcdset{scale cd/.style={every label/.append style={scale=#1},
% %     cells={nodes={scale=#1}}}}
% \tikzcdset{row sep/normal=0.22cm}
% \tikzcdset{column sep/normal=0.02cm}
% Used for displaying a sample figure. If possible, figure files should
% be included in EPS format.
%
% If you use the hyperref package, please uncomment the following two lines
% to display URLs in blue roman font according to Springer's eBook style:

\usepackage{color}

\usepackage{hyperref}

% Configure bookmarks explicitly
\hypersetup{
    bookmarksnumbered=true,
    linkcolor=blue,
    urlcolor=blue
}
\renewcommand\UrlFont{\color{blue}\rmfamily}
\urlstyle{rm}


% \usepackage{amsmath,amssymb,amsfonts}%

%% macros for typesetting
\newcommand{\udl}[1]{\underline{#1}}
\newcommand{\proofbox}[1]{\begin{array}{c} #1 \end{array}}

%% macros for math symbols
\newcommand{\ot}{\otimes}
\newcommand{\cdast}{\circledast}
\newcommand{\Larr}{\Leftarrow}
\newcommand{\Ls}{\Leftarrow^*}
\newcommand{\Rarr}{\Rightarrow}
\newcommand{\Rs}{\Rightarrow^*}
\newcommand{\btleft}{\blacktriangleleft}
\newcommand{\btright}{\blacktriangleright}
\newcommand{\sls}{\slash}
\newcommand{\bsls}{\backslash}
\newcommand{\mc}[1]{\mathcal{#1}}
\newcommand{\mf}[1]{\mathsf{#1}}
\newcommand{\vars}[1]{\mf{var} (#1)}
\newcommand{\gs}[1]{\sigma_{X} (#1)}
\newcommand{\GG}{\Gamma}
\newcommand{\Gg}{\gamma}
\newcommand{\GD}{\Delta}
\newcommand{\Gd}{\delta}
\newcommand{\GL}{\Lambda}
\newcommand{\Gl}{\lambda}
\newcommand{\GO}{\Omega}
\newcommand{\I}{\mf{I}}
\newcommand{\rcons}{\scalebox{0.7}{$\rightarrow$}\!\!::}
% \newcommand{\rcons}{\nersquigarrow::}
\newcommand{\lcons}{\scalebox{0.7}{$\leftarrow$}\!\!::}
% \newcommand{\lcons}{\nwrsquigarrow::}

%% macros for acronyms 
\newcommand{\MIP}{\textsf{MIP}}
\newcommand{\MmIP}{\textsf{MmIP}}
\newcommand{\MIPeq}{{\textsf{MIP}{\circeq}}}
\newcommand{\FL}{$\mathtt{FL}$}
\renewcommand{\L}{$\mathtt{L}$}
\newcommand{\LPfree}{$\mathtt{L_{pf}}$}%{$\mathtt{L}_{(\Rarr, \Larr)}$}
\newcommand{\NL}{$\mathtt{NL}$}

%% macros for derivations
\newcommand{\vd}{\vdash}
\newcommand{\Vd}{\Vdash}
\newcommand{\ax}{\mathsf{ax}}
\newcommand{\tl}{{\otimes}\mathsf{L}}
\newcommand{\tr}{{\otimes}\mathsf{R}}
\newcommand{\Ll}{{\Larr}\mathsf{L}}
\newcommand{\Lsl}{{\Ls}\mathsf{L}}
\newcommand{\Lr}{{\Larr}\mathsf{R}}
\newcommand{\Lsr}{{\Ls}\mathsf{R}}
\newcommand{\Rl}{{\Rarr}\mathsf{L}}
\newcommand{\Rsl}{{\Rs}\mathsf{L}}
\newcommand{\Rr}{{\Rarr}\mathsf{R}}
\newcommand{\Rsr}{{\Rs}\mathsf{R}}
\newcommand{\cut}{\mf{cut}}
\newcommand{\cuts}{\mf{cut}^*}

%% commands for Agda stuff
\newcommand{\At}{\mathsf{At}}
\newcommand{\at}{\mathsf{at}}
\newcommand{\Fma}{\mathsf{Fma}}
\newcommand{\data}{\mathsf{data}}
\newcommand{\Tree}{\mathsf{Tree}}
\newcommand{\append}{+\!\!+}
\newcommand{\where}{\mathsf{where}}
\newcommand{\Set}{\mathsf{Set}}
\newcommand{\record}{\mathsf{record}}
\newcommand{\field}{\mathsf{field}}
\newcommand{\subst}{\mathsf{subst}}
\newcommand{\inT}{\in^{\mf{T}}}
% \newcommand{\append}{{~ ++ ~}}

%% macros for names
\newcommand{\cub}{\v{C}ubri{\'c}}

%% macros for text colors
\newcommand{\tred}[1]{\textcolor{red}{#1}}

\newcommand{\niccolo}[1]{\textcolor{red}{NV: #1}}
\newcommand{\cheng}[1]{\textcolor{blue}{CSW: #1}}

\usepackage{bookmark}

\makeatletter
\AtBeginDocument{
  % Force the depth back to 3 (subsections)
  \setcounter{tocdepth}{3}
  \setcounter{secnumdepth}{3} 
  
  % Ensure bookmarks are numbered and open
  \hypersetup{
    bookmarksnumbered=true,
    bookmarksopen=true
  }
}
\makeatother

\begin{document}
%
\title{Proof-relevance and Well-definedness of Maehara Interpolation in the Lambek Calculus}
%
\titlerunning{Proof-relevant Maehara Interpolation in the Lambek Calculus}
% If the paper title is too long for the running head, you can set
% an abbreviated paper title here
%
\author{Niccol{\`o} Veltri\orcidID{0000-0002-7230-3436} \and
Cheng-Syuan Wan \orcidID{0000-0003-2053-1688}}
%
\authorrunning{N. Veltri and C.-S. Wan}
% First names are abbreviated in the running head.
% If there are more than two authors, 'et al.' is used.
%
\institute{Tallinn University of Technology, Tallinn, Estonia
\\
\email{\{niccolo,cswan\}@cs.ioc.ee}}
%
\maketitle              % typeset the header of the contribution
%
\begin{abstract}
  This work investigates technical aspects of the Maehara interpolation property and Maehara's method, typically employed as an effective proof-theoretic method for establishing Craig interpolation in substructural logics.
  %that pushes a step further from ordinary Maehara (multi-)interpolation in the literature.
  We show that, in the sequent calculus formulation of Lambek calculus, the admissible cut rule is a left inverse of the procedure underlying Maehara's methods, a property recently named ``proof-relevant'' or ``Maehara-Čubrić'' interpolation.
  %which recently is also known as Maehara-Čubrić interpolation.
  We also prove that the interpolation procedure is well-defined wrt.\ a natural notion of equivalence of derivations.
  This is done by imposing an appropriate ``zig-zag'' equivalence relation on %interpolant triples, i.e.
  the formulae and derivations generated by the interpolation procedure.
  Finally, we perform a similar analysis in the product-free Lambek calculus, in which Maehara's method is not applicable and the proof of Craig interpolation requires a more sophisticated multi-interpolation procedure due to Pentus.
\keywords{Lambek calculus \and Maehara interpolation \and proof-relevant interpolation \and Agda}
\end{abstract}
%
%
%

\section{Introduction}\label{sec:intro}
%\emph{Substructural logics} are logical systems allowing a fine control on the use and production of formulae/resources. A notable instance is \emph{Lambek's syntactic calculus} \cite{lambek:mathematics:58}, which forbids the structural rules of weakening, contraction and exchange, 
%%The sequent calculus formulation of Lambek calculus (\L) has the sequents of the form $\GG \vd C$ where the $\GG$ is an oredered list of formulae.
%and has been extensively studied in the literature for its linguistic applications \cite{Pentus1997,moot:categorial:2012}.
%%Another well-known instance is linear logic, which (usually) does not forbid exchange and it has application to resource-sensitive programming languages \niccolo{Citation}.

In most of the systems investigated by proof theorists, such as the sequent calculus and natural deduction, proofs are represented as finite trees, which are built inductively from a set of deductive rules.
But proof theorists are not only interested in in the way in which proofs can be constructed, they also care about \emph{equality of proofs}, i.e. deductive systems are specified by a set of deductive rules and a set of equality rules. The latter typically consist of $\beta$- and $\eta$-equivalences plus a large number of permutative conversions.
Proof theorists can produce these set of equations, which generate an equivalence relation $\circeq$ on derivations, in various ways. Possibly as an axiomatization of equality in categorical models, e.g. two derivations (or terms) $f,f'$ in intuitionistic logic should be considered equal, i.e. $f \circeq f'$, iff the intepretations of $f$ and $f'$ are equal in every Cartesian closed category. Alternatively, the equality rules can be obtained by studiying geometric representations of proofs, e.g. in linear logic $f \circeq f'$ iff $f$ and $f'$ have the same proof net \niccolo{Citation}.

In this paper, we are interested in the relationship between equivalence of derivations and interpolation properties, such as Craig interpolation and its generalizations, in substructural logics, i.e. logical systems allowing a fine control on the use and production of formulae/resources. Concretely, we study this relationship in the sequent calculus formulation of \emph{Lambek's syntactic calculus} (\L) \cite{lambek:mathematics:58}, which forbids the structural rules of weakening, contraction and exchange,
%The sequent calculus formulation of Lambek calculus (\L) has the sequents of the form $\GG \vd C$ where the $\GG$ is an oredered list of formulae.
and has been extensively studied for its linguistic applications \cite{Pentus1997,moot:categorial:2012}.

\emph{Craig interpolation} is a fundamental property of logical systems \cite{craig:interpolation:1957}.
It has been studied for various logics including, e.g.\ classical logic \cite{craig:interpolation:1957}, intermediate logics \cite{Maksimova1977}, and substructural logics \cite{Galatos2007}.
A logic $\mc{L}$ enjoys Craig interpolation if for any theorem $A \to C$ (where $\to$ is the implication connective in $\mc{L}$), there exists an intermediate formula $B$ such that both $A \to B$ and $B \to C$ are theorems in $\mc{L}$ and $\vars{B}\subseteq \vars{A} \cap \vars{C}$, where $\vars{A}$ denotes the set of atomic formulae appearing in $A$.
%Deductive interpolation is a generalized property, where the role of implication $\to$ is replaced by the consequence relation $\vd$.
%For any formula $A$ and $C$, if $A \vd C$, then there exists a formula $B$ such that $A \vd B$, $B \vd C$ and $\vars{B}\subseteq \vars{A} \cap \vars{C}$.
A generalization of Craig interpolation is \emph{Maehara interpolation} (\MIP), also known as strong deductive interpolation. In \L, this property states that for a derivation $f : \GG , \GD , \GL \vd C$ with a specified sublist $\GD$ of the antecedent, there exist a formula $D$ and two derivations $g : \GG, D, \GL \vdash C$ and $h : \GD \vdash D$ such that $\vars{D} \subseteq \vars{\GD} \cap \vars{\GG, \GL, C}$.
The property \MIP\ is usually proved by Maehara's method \cite{maehara1961}, i.e.\ by induction on the derivation $f$, which we will refer to as \emph{(Maehara) interpolation procedure}.
The applicability of the method relies on the existence of a cut-free  sequent calculus for the logic under investigation.
We call the triple $(D,g,h)$ of a formula $D$ and derivations $g$ and $h$ outputted by the interpolation procedure as \emph{interpolation triples}.


%given a derivation $f : \Gamma$ further allows the antecedent of the consequence relation to be a set, a multiset or a list, depending on $\mc{L}$.
%For example, Theorem \ref{thm:MIP} is \MIP\ for \L.
%We call $(D , g : \GG , D , \GL \vd C , h : \GD \vd D)$ the interpolant triple of $f : \GG , \GD , \GL \vd C$ if it is obtained by applying \MIP\ on $f$.
 
Traditionally, \MIP\ only states the \emph{mere existence} of an interpolant triple, but it does not say how the input derivation relates to this triple.
In this work, we are interested in a \emph{proof-relevant} version of  Maehara interpolation, also known as \emph{Maehara-\cub\ interpolation}, that exhibits such relationship.
In \L, proof-relevant interpolation states that, if the interpolation procedure on $f$ produces an interpolation triple $(D,g,h)$, then $\cut \ (h , g) \circeq f$, where $\cut$ is the admissible cut rule.
In other words, \MIP\ is a right inverse of the admissible cut up to $\circeq$.
This line of work has been initiated in the 90s by \cub~\cite{vcubric1993results,Cubric1994}, who proved proof-relevant interpolation for the simply typed $\lambda$-calculus with sum types,
%and its relation to categorical models.
and has been recently revived by Saurin, who proved proof-relevant interpolation for (extensions) of classical linear logic \cite{Saurin2024} and considered generalizations to sequent calculi with primitive cut rule and to proof nets \cite{Saurin2025}.
In previous work we also contributed to this line of research, by studying proof-relevant interpolation for a semi-associative fragment of \L~\cite{VW2025}, as well as for the nonassociative Lambek calculus (\NL) \cite{VW2025Tableaux}.

In \cite{VW2025Tableaux}, we also raised the question of \emph{well-definedness} of the Maehara interpolation procedure.
When a deductive system comes equipped with an equivalence of derivations $\circeq$, so that equivalent proofs are to be considered equal, then the interpolation procedure should send equivalent derivations to equivalent interpolation triples.
But what is the right notion of equivalence for these triples that makes the interpolation procedure well-defined?
For \NL, we showed  that two interpolant triples $(D , g, h)$ and $(D' , g', h')$ can be considered equivalent if $D = D$, $g \circeq g'$ and $h \circeq h'$ \cite{VW2025Tableaux}. In particular, the interpolant formulae $D$ and $D'$ produced by equivalent derivations $f \circeq f'$ are the same.
%Then a question arises: is the equivalence of derivations preserved by \MIP? In other words, for any $f$ and $f'$, if $f \circeq f'$, then are their interpolant triples are equivalent? We call this \emph{well-definedness} of \MIP.
%In \NL, the answer is positive and the definition of equivalent interpolant triples is appropriate. 

However, this notion of equivalence of interpolant triples is not appropriate in \L. It is possible to show that there exist equivalent derivations $f \circeq f'$ that have distinct interpolation formulae $D \not= D'$ . Even more, $D$ and $D'$ may not even be logically equivalent.
%Consider the example equation of derivations $\tr \ (\Rl \ (f , f'),f'') \circeq \Rl \ (f, \tr \ (f',f''))$ in (\ref{eq:ct:example}). The interpolant formulae of the two derivations are $(D \Rarr E) \ot F$ and $D \Rarr (E \ot F)$, respectively.
%Therefore it leads to a more relaxed equivalence on interpolant triples.
We therefore propose a different \emph{zig-zag} equivalence of interpolant triples which implies the well-definedness of the interpolation procedure in \L. The equivalence of triples $(D , g, h) \sim (D' , g', h')$ is the symmetric-transitive closure of the relation stating that there exists a derivation $t : D \vd D'$ such that $g \circeq \cut \ (t , g')$ and $\cut \ (h , t) \circeq h'$. This might look like an unusual notion of
equality between interpolants, but it is in fact very natural
from a category-theoretic perspective, since it characterizes the collection of interpolant triples as some kind of colimit/coend \niccolo{Citation}.

Finally, we look at the \emph{product-free} Lambek calculus (\LPfree), i.e. the fragment of \L\ without multiplicative conjunction.
Pentus showed that \LPfree\ does not enjoy Maehara interpolation, but Craig interpolation can still be proved using a more complex \emph{Maehara multi-interpolation} property. We conclude our paper by establishing a proof-relevant version of Pentus' multi-interpolation and studying an appropiate equivalence of interpolant quadruples (not triples, in this more complex situation) that implies well-definedness of the multi-interpolation procedure. 

%\paragraph{Contributions} In this paper, we establish the following results: 
%\begin{enumerate}
%  \item \MIP\ is a right inverse of the admissible cut rule in \L\ (Theorem \ref{thm:cut:intrp:L}).
%  \item We introduce an equivalence relation interpolant triples and then show that \MIP\ is well-defined wrt.\ $\circeq$, the equivalence relation on derivations in \L\ (Theorem \ref{thm:welldef:L}).
%  \item The aforementioned results are extended to the product-free Lambek calculus (\LPfree) with Maehara multi-interpolation (\MmIP) \cite{Pentus1997} (Theorems \ref{thm:cut:intrp:LPfree} and \ref{thm:welldef:LPfree}).
%\end{enumerate}  
%\vspace*{-0.5cm}

\section{Sequent Calculus of Lambek calculus}\label{sec:seqcalc}
We briefly recall the sequent calculus for the Lambek calculus (\L), especially the effective procedures for proving cut admissibility \cite{moot:categorial:2012} and Maehara interpolation \cite{roorda1991,ono:proof:nonclassical:1998,moot:categorial:2012}, which will be employed in later sections.

Formulae of \L\ are inductively generated by the grammar $A, B ::= X \ | \ A \Rarr B \ | \ B \Larr A \ | \ A \ot B$, where $X$ is drawn from a set $\mathsf{At}$ of atomic formulae, ${\Larr}$ and ${\Rarr}$ are implications/residuals and ${\ot}$ is fusion/multiplicative conjunction.
Sequents in \L\ have the form $\GG \vd C$ where the antecedent (or context) $\GG$ is a (possibly empty) list of formulae and $C$ is a single formula.
%In the rest of the paper, we sometimes call $\GG$ a context.
Derivations of \L\ are inductively generated by the following rules:

\begin{equation*}\label{eq:seqcalc}
\begin{array}{c}
  \infer[\ax]{A \vd A}{}
  \quad
  \infer[\Rr]{\GG \vd A \Rarr B}{A , \GG \vd B} 
  \quad
  \infer[\Lr]{\GG \vd B \Larr A}{\GG , A \vd B}
  \quad
    \infer[\tr]{\GG , \GD \vd A \ot B}{
    \GG \vd A
    &
    \GD \vd B
  }
  \\[7pt]
  \infer[\Rl]{\GG , A \Rarr B , \GL \vd C}{
    \GD \vd A
    &
    \GG , B , \GL \vd C
  }
  \quad
  \infer[\Ll]{\GG , B \Larr A , \GL \vd C}{
    U \vd A
    &
    \GG , B , \GL \vd C
  }
  \quad
  \infer[\tl]{\GG , A \ot B , \GD \vd C}{
    \GG , A , B , \GD \vd C
  }
\end{array}
\end{equation*}

\begin{theorem}[Cut admissibility for \L]\label{thm:cut}
  The cut rule is admissible in \L.
  \[
  \infer[\cut]{\GG , \GD , \GL \vd C}{
    \GD \vd A
    &
    \GG , A , \GL \vd C
  }
  \]
\end{theorem}
\begin{proof}
  Proof proceeds by structural induction on the second premise and the complexity of the cut formula.
  % The cases are straightforward when the second premise is $\ax$, a conclusion of a right rule, or a conclusion of a left rule but the cut formula is different from the principal formula.
  If the second premise $\ax$, then $\cut\ (f , \ax) = f$. 
  If the second premise is a conclusion of a right rule, or a conclusion of a left rule but the cut formula is different from the principal formula, then we permute the corresponding rule down and continue recursively.
  
  We perform a further induction on the first premise when the cut formula coincides with the principal formula of a left rule.
  If the principal formula is not the cut formula in the first premise, then we permute the rule down and continue recursively.
  If the principal formula is the cut formula, then we do the following:
  \begin{itemize}
    \item $\cut\ (\tr \ (f', f'') , \tl \ g') = \cut \ (f' , \cut\ (f'', g'))$,
    \item $\cut \ (\Rr \ f' , \Rl \ (g' , g'')) = \cut \ (g' , \cut \ (f' , g''))$ and
    \item $\cut \ (\Lr \ f' , \Ll \ (g' , g'')) = \cut \ (g' , \cut \ (f' , g''))$.
  \end{itemize}
  % \[
  %   \begin{array}{l}
  %     \proofbox{
  %       \infer[\cut]{\GG , \GD_0 , \GD_1 , \GL \vd C}{
  %       \infer[\tr]{\GD_0 , \GD_1 \vd A' \ot B'}{
  %         \deduce{\GD_0 \vd A'}{f'}
  %         &
  %         \deduce{\GD_1 \vd B'}{f''}
  %       }
  %       &
  %       \infer[\tl]{\GG , A' \ot B' \GL \vd C}{
  %         \deduce{\GG , A' , B' \GL \vd C}{g'}
  %       }
  %     }
  %     }
  %     \\
  %     \hspace*{4cm}=\qquad
  %     \proofbox{
  %       \infer[\cut]{\GG , \GD_0 , \GD_1 , \GL \vd C}{
  %       \deduce{\GD_0 \vd A'}{f'}
  %       &
  %       \infer[\cut]{\GG , A' , \GD_1 , \GL \vd C}{
  %         \deduce{\GD_1 \vd B'}{f''}
  %         &
  %         \deduce{\GG , A' , B' \GL \vd C}{g'}
  %       }
  %     }
  %     }
  %     \\[5pt]
  %     \proofbox{
  %       \infer[\cut]{\GG_0 , \GG_1 , \GD , \GL \vd C}{
  %       \infer[\Rr]{\GD \vd A' \Rarr B'}{
  %         \deduce{A' , \GD \vd B'}{f'}
  %       }
  %       &
  %       \infer[\Rl]{\GG_0 , \GG_1 , A' \Rarr B' , \GL \vd C}{
  %         \deduce{\GG_1 \vd A'}{g'}
  %         &
  %         \deduce{\GG_0 , B , \GL \vd C}{g''}
  %       }
  %     }
  %     }
  %     \\
  %     \hspace*{4cm}=\qquad
  %     \proofbox{
  %       \infer[\cut]{\GG_0 , \GG_1 , \GD , \GL \vd C}{
  %         \deduce{\GG_1 \vd A'}{g'}
  %         &
  %         \infer[\cut]{\GG_0 , A' , \GD , \GL \vd C}{
  %           \deduce{A' , \GD \vd B'}{f'}
  %           &
  %           \deduce{\GG_0 , B , \GL \vd C}{g''}
  %         }
  %       }
  %     }
  %   \end{array}
  % \]
  % The case for $\cut \ (\Lr \ f' , \Ll \ (g' ,g''))$ is similar.
\end{proof}
% The following equations hold in \L\ due to the cut admissibility procedure defined in the proof of Theorem \ref{thm:cut}.
% \begin{equation}\label{eq:cut:assoc}
%   \begin{array}{l}
%     \proofbox{
%       \infer[\cut]{\GG' , \GG , \GD , \GL , \GL' \vd C}{
%       \infer[\cut]{\GG , \GD ,\GL \vd A'}{
%         \deduce{\GD \vd A}{f}
%         &
%         \deduce{\GG , B , \GL \vd A'}{g}
%       }
%       &
%       \deduce{\GG' , A' , \GL' \vd C}{h}
%     }
%     }
%     \\
%     \hspace*{3cm}=\quad
%     \proofbox{
%       \infer[\cut]{\GG' , \GG , \GD , \GL , \GL' \vd C}{
%         \deduce{\GD \vd A}{f}
%         &
%       \infer[\cut]{\GG' ,\GG , A ,\GL,\GL' \vd C}{
%         \deduce{\GG , B , \GL \vd A'}{g}
%         &
%         \deduce{\GG' , A' , \GL' \vd C}{h}
%       }
%     }
%     }
%   \end{array}
% \end{equation}
% \begin{equation}
%   \begin{array}{l}
%     \proofbox{
%       \infer[\cut]{\GG , \GD_0 , \GL , \GD_1 , \GO \vd C}{
%       \deduce{\GD_0 \vd A}{f}
%       &
%       \infer[\cut]{\GG , A , \GL , \GD_1 , \GO \vd C}{
%         \deduce{\GD_1 \vd A'}{f'}
%         &
%         \deduce{\GG , A , \GL , A' , \GO \vd C}{g}
%       }
%     }
%     }
%     \\
%     \hspace*{3cm}=\quad
%     \proofbox{
%       \infer[\cut]{\GG , \GD_0 , \GL , \GD_1 , \GO \vd C}{
%       \deduce{\GD_1 \vd A'}{f'}
%       &
%       \infer[\cut]{\GG , \GD_0 , \GL , A' , \GO \vd C}{
%         \deduce{\GD_0 \vd A}{f}
%         &
%         \deduce{\GG , A , \GL , A' , \GO \vd C}{g}
%       }
%     }
%     }
%   \end{array}
% \end{equation}
\begin{theorem}[Maehara interpolation for \L]\label{thm:MIP}
  Given a derivation $f : \GG , \GD , \GL \vd C$, there exist a formula $D$ and two derivations $g : \GG, D, \GL \vdash C$ and $h : \GD \vdash D$ such that $\vars{D} \subseteq \vars{\GD} \cap \vars{\GG, \GL, C}$
\end{theorem}
\begin{proof}
  Proof proceeds by structural induction on the derivation $f$.
  We show the most complicated case, \ $f = \Rl \ (f' , f'')$, which will be recalled multiple times in the rest of the paper:
  \[
    \infer[\Rl]{\GG' , \GD' , A \Rarr B , \GL' \vd C}{
        \deduce{\GD' \vd A}{f'}
        &
        \deduce{\GG' , B, \GL' \vd C}{f''}
    }
  \]
  There are six subcases. The first four cases are: $\GD$ is contained in either $\GG'$, $\GD'$ or $\GL'$ or $\GD$ contains $\GD' , A \Rarr B$. In these cases, we apply the inductive hypothesis appropriately to obtain desired interpolant formula and derivations.
  For example, if $\GD$ is contained in $\GD'$, i.e.\ $\GD' = \GD'_0 , \GD , \GD'_1$, then by inductive hypothesis on $f'$, there exist a formula $D$ and two derivations $g' : \GD'_0 , D , \GD'_1 \vd A$ and $h' : \GD \vd D$. In this case the desired interpolant formula is $D$ and two desired derivations are constructed as follows: 
  \[
    \begin{array}{c}
    \proofbox{
      \infer[\Rl]{\GG' , \GD'_0 , D , \GD'_1 , A \Rarr B , \GL' \vd C}{
        \deduce{\GD'_0 , D , \GD'_1 \vd A}{g'}
        &
        \deduce{\GG' , B, \GL' \vd C}{f''}
      }
    }
      \qquad
      \proofbox{
        \deduce{\GD \vd D}{h'}
      }
    \end{array}
  \]
  The variable condition holds automatically.

  We show the rest two interesting cases. The first one is when $\GG' = \GG'_0 , \GG'_1$, $\GD' = \GD'_0 , \GD'_1$ and $\GD = \GG'_1 , \GD'_0$ ($\GD$ splits both $\GG'$ and $\GD'$). In this case, we apply inductive hypothesis on $f'$ and $f''$ respectively to obtain
      \begin{itemize}
      \item a formula $D$,
      \item derivations $g' : D , \GD'_1 \vd A$ and $h' : \GD'_0 \vd D$ such that
      \item $\vars{D} \subseteq \vars{\GD'_0} \cap \vars{\GD'_1 , A}$ and
    \end{itemize}
      \begin{itemize}
      \item a formula $E$,
      \item derivations $g'' : \GG'_0 , E , B , \GL' \vd C$ and $h'' : \GG'_1 \vd E$ such that
      \item $\vars{E} \subseteq \vars{\GG'_1} \cap \vars{\GG'_0 , B , \GL' , C}$.
    \end{itemize}
  The desired interpolant formula in this case is $E \ot D$ and the desired derivations are constructed as follows:
  \[
  \begin{array}{c}
    \proofbox{
      \infer[\tl]{\GG'_0 , E \ot D  , A \Rarr B , \GL' \vd C}{
        \infer[\Rl]{\GG'_0 , E , D  , A \Rarr B , \GL' \vd C}{
          \deduce{D , \GD'_1 \vd A}{g'}
          &
          \deduce{\GG'_0 , E , B , \GL' \vd C}{g''}
        }
      }
    }
    \qquad
    \proofbox{
      \infer[\tr]{\GG'_1 , \GD'_0 \vd E \ot D}{
        \deduce{\GG'_1 \vd E}{h''}
        &
        \deduce{\GD'_0 \vd D}{h'}
      }
    }
  \end{array}
  \]
  The variable condition is easy to check.

  The second interesting case is when $\GD' = \GD'_0 , \GD'_1$, $\GL' = \GL'_0 , \GD'_1$ and $\GD = \GD'_1 , A \Rarr B , \GL'_0$ ($\GD$ splits both $\GD'$ and $\GL'$ and contains $A \Rarr B$).
  In this case, we apply inductive hypothesis on $f'$ and $f''$ respectively to obtain
      \begin{itemize}
      \item a formula $D$,
      \item derivations $g' : D , \GD'_1 \vd A$ and $h' : \GD'_0 \vd D$ such that
      \item $\vars{D} \subseteq \vars{\GD'_0} \cap \vars{\GD'_1 , A}$ and
    \end{itemize}
      \begin{itemize}
      \item a formula $E$,
      \item derivations $g'' : \GG' , E , \GL'_1 \vd C$ and $h'' : B , \GL'_0 \vd E$ such that
      \item $\vars{E} \subseteq \vars{B , \GL'_0} \cap \vars{\GG' , \GL'_1 , C}$.
    \end{itemize}
    The desired interpolant formula is $D \Rarr E$ and the desired derivations are constructed as follows:
    \[
    \begin{array}{c}
      \proofbox{
        \infer[\Rl]{\GG' , \GD'_0 , D \Rarr E , \GL'_1 \vd C}{
          \deduce{\GD'_0 \vd D}{h'}
          &
          \deduce{\GG' , E , \GL'_1 \vd C}{g''}
        }
      }
      \qquad
      \proofbox{
        \infer[\Rr]{\GD'_1 , A \Rarr B , \GL'_0 \vd D \Rarr E}{
          \infer[\Rl]{D , \GD'_1 , A \Rarr B , \GL'_0 \vd E}{
            \deduce{D , \GD'_1 \vd A}{g'}
            &
            \deduce{B , \GL'_0 \vd E}{h''}
          }
        }
      }
    \end{array}
    \]
    The variable condition is easy to check as well.
\end{proof}
Recall that $(D , g , h)$ is  the interpolant triple of $f : \GG , \GD , \GL \vd C$ obtained by applying \MIP\ procedure on $f$.
\niccolo{What about using the notation $\mf{mip}(\GD,f)$ for the interpolation procedure applied to $f$ with subcontext $\Delta$? So we can then write $\mf{mip}(\GD,f) = (D,g,h)$.}

\section{Equivalence of Derivations}\label{sec:equiv:derivation}
In sequent calculus, some sequents may have different derivations, but 
some of them ``morally'' the same, they differ syntactically because of the flexibility of the inference rules.
For example, the sequent $\GG , \GD , A \Rarr B , \GL \vd A' \Rarr B'$ in \L\ has two different proofs, assuming given derivations $f : \GD \vd A$ and $f' : A' , \GG , B , \GL \vd B'$:
\[
\begin{array}{c}
  \proofbox{\infer[\Rl]{\GG , \GD , A \Rarr B , \GL \vd A' \Rarr B'}{
    \deduce{\GD \vd A}{f}
    &
    \infer[\Rr]{\GG , B , \GL \vd A' \Rarr B'}{
      \deduce{A' , \GG , B , \GL \vd B'}{f'}
    }
  }
  }
  \qquad
  \proofbox{\infer[\Rr]{\GG , \GD , A \Rarr B , \GL \vd A' \Rarr B'}{
    \infer[\Rl]{A' , \GG , \GD , A \Rarr B, \GL \vd B'}{
      \deduce{\GD \vd A}{f}
      &
      \deduce{A' , \GG , B , \GL \vd B'}{f'}
    }
  }
  }
\end{array}
\]
Intuitively, these two derivations should be considered equal in \L\ since the rules $\Rl$ and $\Rr$ act on completely disjoint parts of the sequent and can therefore be permuted.
Formally, one can show that these derivations have the same interpretation in all monoidal biclosed categories, which are the categorical models of \L\ \niccolo{Cite old Lambek}, or that they have the same underlying proof net \cite{roorda1991}.

%In this section, we introduce an equivalence relation $\circeq$ on derivations in \L\ that serves as a base for the subsequent discussion on behavior of equivalent derivations wrt.\ cut admissibility and \MIP.

%The equivalence relation $\circeq$ that is defined by a collection of equations of derivations.


This semantic notion of equality can be axiomatized and gives rise to an equivalence of derivations $\circeq$.
This is the smallest congruence relation generated by the following equations: %collection contains the following data: ($i$) the relation is an equivalence relation; ($ii$) the congruence of each logical rule, e.g.\ $\Rr \ f \circeq \Rr \ f'$ if $f \circeq f'$ and $\Rl ~ (f , f_1) \circeq \Rl ~ (f' , f'_1)$ if $f \circeq f'$ and $f_1 \circeq f'_1$;
($i$) $\eta$-equivalences, i.e.\ each instance of the rule $\ax$ on a compound formula can be expanded using left and right rules to a derivations using $\ax$ on simpler formulae, e.g.\ see the $\eta$-expansion of $\ax$ on $A \Rarr B$ in (\ref{eq:eta:tr});
($ii$) permutation of left and right rules, e.g.\ see how $\tr$ permutes with $\Rl$ in (\ref{eq:tr:rl:comm});
($iii$) permutation of \emph{consecutive} applications of left rules, e.g.\ see how $\Rl$ permutes with $\Ll$ in (\ref{eq:rl:ll:assoc});
($vi$) permutation of \emph{disjiont} applications of left rules, e.g.\ see how two instances of $\Rl$ permute with each other in (\ref{eq:rl:comm}).
% \begin{figure}[t]
% \normalsize

\begin{equation}\label{eq:eta:tr}
\begin{array}{c}
    \proofbox{
    \infer[\ax]{A \Rarr B \vd A \Rarr B}{}
  }
  \quad\circeq\quad
  \proofbox{
    \infer[\Rr]{A \Rarr B \vd A \Rarr B}{
    \infer[\Rl]{A , A \Rarr B \vd B}{
      \infer[\ax]{A \vd A}{}
      &
      \infer[\ax]{B \vd B}{}
    }
  }
  }
\end{array}
\end{equation}
\begin{equation}\label{eq:tr:rl:comm}
  \begin{array}{l}
    \proofbox{\infer[\tr]{\GG , \GD , A \Rarr B , \GL , \GO \vd A' \ot B'}{
    \infer[\Rl]{\GG , \GD , A \Rarr B , \GL \vd A'}{
      \deduce{\GD \vd A}{f}
      &
      \deduce{\GG , B , \GL \vd A'}{f'}
    }
    &
    \deduce{\GO \vd B'}{f''}
  }
  }
  \\
  \hspace*{3cm}
  \circeq
  \quad
  \proofbox{\infer[\Rl]{\GG , \GD , A \Rarr B , \GL , \GO \vd A' \ot B'}{
    \deduce{\GD \vd A}{f}
    &
    \infer[\tr]{\GG , B , \GL , \GO \vd A' \ot B'}{
      \deduce{\GG , B , \GL \vd A'}{f'}
      &
      \deduce{\GO \vd B'}{f''}
    }
  }
  }
  \end{array}
\end{equation}
\begin{equation}\label{eq:rl:ll:assoc}
  \begin{array}{l}
    \proofbox{
    \infer[\Rl]{\GG' , B' \Larr A' ,  \GG , \GD , A \Rarr B , \GL , \GL' \vd C}{
      \deduce{\GD \vd A}{f}
      &
      \infer[\Ll]{\GG' , B' \Larr A' ,  \GG , B , \GL , \GL' \vd C}{
        \deduce{\GG , B , \GL \vd A'}{f'}
        &
        \deduce{\GG' , B' , \GL' \vd C}{f''}
      }
    }
  }
  \\
  \hspace*{3cm}
  \circeq
  \quad
  \proofbox{
    \infer[\Ll]{\GG' , B' \Larr A' ,  \GG , \GD , A \Rarr B , \GL , \GL' \vd C}{
      \infer[\Rl]{\GG , \GD , A \Rarr B , \GL \vd A'}{
        \deduce{\GD \vd A}{f}
        &
        \deduce{\GG , B , \GL \vd A'}{f'}
      }
      &
      \deduce{\GG' , B' , \GL' \vd C}{f''}
    }
  }
  \end{array}
\end{equation}
% \begin{equation}\label{eq:rl:assoc}
%   \begin{array}{l}
%     \proofbox{
%     \infer[\Rl]{\GO_0 , \GG , \GD , A \Rarr B , \GL , A' \Rarr B', \GO_1 \vd C}{
%       \deduce{\GD \vd A}{f}
%       &
%       \infer[\Rl]{\GO_0 , \GG , B , \GL , A' \Rarr B' , \GO_1 \vd C}{
%         \deduce{\GG , B , \GL \vd A'}{f'}
%         &
%         \deduce{\GO_0 , B' , \GO_1 \vd C}{f''}
%       }
%     }
%   }
%   \\
%   \hspace*{3cm}
%   \circeq
%   \quad
%   \proofbox{
%     \infer[\Rl]{\GO_0 , \GG , \GD , A \Rarr B , \GL , A' \Rarr B', \GO_1 \vd C}{
%       \infer[\Rl]{\GG , \GD , A \Rarr B , \GL \vd A'}{
%         \deduce{\GD \vd A}{f}
%         &
%         \deduce{\GG , B , \GL \vd A'}{f'}
%       }
%       &
%       \deduce{\GO_0 , B' , \GO_1 \vd C}{f''}
%     }
%   }
%   \end{array}
% \end{equation}
\begin{equation}\label{eq:rl:comm}
  \begin{array}{l}
    \proofbox{
    \infer[\Rl]{\GG , \GD_0 , A \Rarr B , \GL , \GD_1 , A' \Rarr B', \GO \vd C}{
      \deduce{\GD_0 \vd A}{f}
      &
      \infer[\Rl]{\GG , B , \GL , \GD_1 , A' \Rarr B', \GO \vd C}{
        \deduce{\GD_1 \vd A'}{f'}
        &
        \deduce{\GG , B , \GL , B', \GO \vd C}{f''}
      }
    }
  }
  \\
  \hspace*{3cm}
  \circeq
  \quad
  \proofbox{
    \infer[\Rl]{\GG , \GD_0 , A \Rarr B , \GL , \GD_1 , A' \Rarr B', \GO \vd C}{
      \deduce{\GD_1 \vd A'}{f'}
      &
      \infer[\Rl]{\GG , \GD_0 , A \Rarr B , \GL , B', \GO \vd C}{
        \deduce{\GD_0 \vd A}{f}
        &
        \deduce{\GG , B , \GL , B', \GO \vd C}{f''}
      }
    }
  }
  \end{array}
\end{equation}
% \caption{Examples of $\eta$-expansion and permutative conversions}
% \label{fig:conv}
% \end{figure}

\begin{lemma}\label{lem:left:rules:cut}
  The following equivalences are provable in \L:
  \begin{itemize}
    \item $\cut \ (\ax , g) \circeq g$,
    \item $\cut\ (\Rl \ (f' , f''), g') \circeq \Rl \ (f',\cut \ (f'',g))$ and 
    \item $\cut\ (\Ll \ (f' , f''), g') \circeq \Ll \ (f',\cut \ (f'',g))$ 
  \end{itemize}
  %   \[
  % \begin{array}{l}
  %   \multicolumn{1}{c}{
  %     \proofbox{
  %     \infer[\cut]{\GG , A , \GL \vd C}{
  %       \infer[\ax]{A \vd A}{}
  %       &
  %       \deduce{\GG , A , \GL \vd C}{g}
  %     }
  %   }
  %   \quad\circeq\quad
  %   \proofbox{
  %     \deduce{\GG , A , \GL \vd C}{g}
  %   }
  %   }
  % \end{array}
  % \]
  % \[
  % \begin{array}{l}
  %   \proofbox{
  %     \infer[\cut]{\GG_0 , \GG_1 , \GD , A \Rarr B , \GL_0 , \GL_1 \vd C}{
  %       \infer[\Rl]{\GG_1 , \GD , A \Rarr B , \GL_0 \vd A'}{
  %         \deduce{\GD \vd A}{f'}
  %         &
  %         \deduce{\GG_1 , B , \GL_0 \vd C}{f''}
  %       }
  %       &
  %       \deduce{\GG_0 , A', \GL_1 \vd C}{g}
  %     }
  %   }
  %   \\
  %   \hspace*{4cm}
  %   \circeq\quad
  %   \proofbox{
  %     \infer[\Rl]{\GG_0 , \GG_1 , \GD , A \Rarr B , \GL_0 , \GL_1 \vd C}{
  %       \deduce{\GD \vd A}{f'}
  %       &
  %       \infer[\cut]{\GG_0 , \GG_1 , B , \GL_0 , \GL_1 \vd C}{
  %         \deduce{\GG_1 , B , \GL_0 \vd C}{f''}
  %         &
  %         \deduce{\GG_0 , A', \GL_1 \vd C}{g}
  %       }
  %     }
  %   }
  % \end{array}
  % \]
  % \[
  % \begin{array}{l}
  %   \proofbox{
  %     \infer[\cut]{\GG_0 , \GG_1 , B \Larr A , \GD , \GL_0 , \GL_1 \vd C}{
  %       \infer[\Ll]{\GG_1 , B \Larr A , \GD , \GL_0 \vd A'}{
  %         \deduce{\GD \vd A}{f'}
  %         &
  %         \deduce{\GG_1 , B , \GL_0 \vd C}{f''}
  %       }
  %       &
  %       \deduce{\GG_0 , A', \GL_1 \vd C}{g}
  %     }
  %   }
  %   \\
  %   \hspace*{4cm}
  %   \circeq\quad
  %   \proofbox{
  %     \infer[\Ll]{\GG_0 , \GG_1 , B \Larr A , \GD , \GL_0 , \GL_1 \vd C}{
  %       \deduce{\GD \vd A}{f'}
  %       &
  %       \infer[\cut]{\GG_0 , \GG_1 , B , \GL_0 , \GL_1 \vd C}{
  %         \deduce{\GG_1 , B , \GL_0 \vd C}{f''}
  %         &
  %         \deduce{\GG_0 , D, \GL_1 \vd C}{g}
  %       }
  %     }
  %   }
  % \end{array}
  % \]
\end{lemma}
\begin{proof}
  All proofs proceed by structural induction on the derivation $g$, following the cut admissibility procedure described in the proof of Theorem \ref{thm:cut}.
\end{proof}
% \begin{lemma}\label{lem:cut:cong}
%   For any derivations $f$, $f'$, $g$ and $g'$, if $f \circeq f'$ and $g \circeq g'$, then $\cut \ (f ,g) \circeq \cut \ (f' , g')$.
% \end{lemma}
% \begin{proof}
%   Proof proceeds by induction on all possible equations in \L.
% \end{proof}
% Figure \ref{fig:conv} contains the examples of the equations of derivations in \L.
% The equations split to four groups: ($i$) $\eta$-expansion of $\ax$, i.e.\ an instance of $\ax$ of a compound formula is equivalent to the expansion with left and right rules applying on instances of $\ax$ of simpler formulae ($\ax$ of $A \Rarr B$ expands to $\Rr \ (\Rl \ (\ax ,\ax))$ with $\ax$ of $A$ and $\ax$ of $B$); ($ii$) left and right introduction rules can always be permuted ($\tr$ permutes with $\Rl$ in the figure); ($iii$) consecutive application of left rules is associative (two $\Rl$ instances permute with each other in the figure, where $B$ and $B'$ are in different sequents); ($iv$) consecutive application of left rules is commutative (two $\Rl$ instances permute with each other in the figure, where $B$ and $B'$ are in the same sequent).
% \vspace*{-0.8cm}
% also cut can be permuted with left rules in the first premise


\section{Proof-relevant  and Well-defined Interpolation}
In this section, we show a proof-relevant version of Maehara interpolation in \L, proving that the interpolation procedure is a right inverse of the admissible $\cut$ rule.
We also prove that the procedure is well-defined wrt.\ the equivalence relation $\circeq$, by introducing an appropriate notion of equivalence of interpolant triples.
% The proof of \ref{thm:cut:intrp:L} is standard as the proofs for other substructural logics, such as classical (intuitionistic) logic \cite{Saurin2024} and nonassociative Lambek calculus \cite{VW2025Tableaux}.
% However, the well-definedness of Mae

\begin{theorem}[Proof-relevant interpolation for \L]\label{thm:cut:intrp:L}
~
\\
  For derivations $g : \GG , D , \GL \vd C$ and $h : \GD \vd D$ obtained by interpolating the derivation $f : \GG , \GD , \GL \vd C$, $\cut \ (h , g) \circeq f$.
\end{theorem}
\begin{proof}
  The proof proceeds by structural induction on the derivation $f$.
  We show the proofs of the interesting subcases of $f = \Rl \ (f' , f''): \GG' , \GD' , A \Rarr B , \GL' \vd C$ mentioned in the proof of Theorem \ref{thm:MIP}.

    The first case is when $\GD$ splits both $\GG'$ and $\GD'$ where the interpolant formula is $E \ot D$. Recall the derivations $g = \tl \ (\Rl \ (g' , g''))$ and $h = \tr \ (h'' , h')$, therefore the goal is to show $\cut \ (\tr \ (h'' , h') , \tl \ (\Rl \ (g' , g''))) \circeq \Rl \ (f' , f'')$, which is witnessed by the following:
    \[
    \begin{array}{lr}
      \cut \ (\tr \ (h'' , h') , \tl \ (\Rl \ (g' , g''))) &
      \\
      = \cut \ (h'' , \cut \ (h' , \Rl \ (g' , g''))) & \text{(by definition of $\cut$)}
      \\
      = \Rl \ (\cut \ (h' , g') , \cut \ (h'' , g'')) & \text{(by definition of $\cut$, twice)}
      \\
      \circeq \Rl \ (f' , f'') & \text{(by ind. hyp. on $f'$ and $f''$}
      \\
      & \text{and congruence)}
    \end{array}
    \]
    The second case is when $\GD$ splits both $\GD'$ and $\GL'$ and contains $A \Rarr B$ and the interpolant formula is $D \Rarr E$.
    Recall the derivations $g = \Rr \ (\Rl \ (g' , h''))$ and $h = \Rl \ (h' , g'')$, therefore the goal is to show $$\cut \ (\Rr \ (\Rl \ (g' , h'')), \Rl \ (h' , g'')) \circeq \Rl \ (f' , f''),$$ which is witnessed by the following:
    \[
    \begin{array}{lr}
      \cut \ (\Rr \ (\Rl \ (g' , h'')), \Rl \ (h' , g'')) &
      \\
      = \cut \ (h' , \cut \ (\Rl \ (g' , h'') , g'')) & \text{(by definition of $\cut$)}
      \\
      \circeq \cut \ (h' , \Rl \ (g' , \cut \ (h'' , g''))) & \text{(by Lemma \ref{lem:left:rules:cut})}
      \\
      = \Rl \ (\cut \ (h' , g') , \cut \ (h'' , g'')) & \text{(by definition of $\cut$)}
      \\
      \circeq \Rl \ (f' , f'') & \text{(by ind. hyp. on $f'$ and $f''$}
      \\
      & \text{and congruence)}
    \end{array}
    \]
    Other cases are similar.
\end{proof}
% Veltri and Wan showed that Maehara interpolation procedure is well-defined wrt. equivalence relation on derivations in nonassociative Lambek calculus \cite{VW2025Tableaux}.
% In particular, consider two interpolant triples $(D , g , h)$ and $(D' , g' , h')$ which are obtained by Maehara interpolation on two derivations $f$ and $f'$, respectively. If $f \circeq f'$, then $D = D'$, $g \circeq g'$ and $h \circeq h'$.
In nonassociative Lambek calculus (\NL), two interpolant triples $(D , g , h)$ and $(D' , g' , h')$ can be considered equivalent if $D = D'$, $g \circeq g'$ and $h \circeq h'$\footnote{Here the relation $\circeq$ is the equivalence of derivations in \NL\ described in \cite{VW2025Tableaux}}. Then the Maehara interpolation procedure in \NL\ is well-defined, in the sense that if it receives in input two $\circeq$-related derivations $f$ and $f'$, it returns equivalent interpolant triples \cite{VW2025Tableaux}.

However, this is not an appropriate definition for interpolant triples in \L. Consider the permutative conversion between $\tr$ and $\Rl$ in (\ref{eq:tr:rl:comm}), and the situation where 
the interpolant context splits $\GD$ and $\GO$, i.e. $\GD = \GD_0 , \GD_1$, $\GO = \GO_0 , \GO_1$ and the interpolant context of the endsequent is $\GD_1 , A \Rarr B , \GL , \GO_0$ (the red text traces the flow of the interpolant context in the derivations):
\begin{equation}\label{eq:ct:example}
  \begin{array}{l}
    \proofbox{\infer[\tr]{\GG , \GD_0 , \tred{\GD_1 , A \Rarr B , \GL , \GO_0} , \GO_1 \vd A' \ot B'}{
    \infer[\Rl]{\GG , \GD_0 , \tred{\GD_1 , A \Rarr B , \GL} \vd A'}{
      \deduce{\GD_0 , \tred{\GD_1} \vd \tred{A}}{f}
      &
      \deduce{\GG , \tred{B , \GL} \vd A'}{f'}
    }
    &
    \deduce{\tred{\GO_0} , \GO_1 \vd B'}{f''}
  }
  }
  \\
  \hspace*{2cm}\circeq\qquad
  \proofbox{\infer[\Rl]{\GG , \GD_0 , \tred{\GD_1 , A \Rarr B , \GL , \GO_0} , \GO_1 \vd A' \ot B'}{
    \deduce{\GD_0 , \tred{\GD_1} \vd \tred{A}}{f}
    &
    \infer[\tr]{\GG , \tred{B , \GL , \GO_0 }, \GO_1 \vd A' \ot B'}{
      \deduce{\GG , \tred{B , \GL} \vd A'}{f'}
      &
      \deduce{\tred{\GO_0} , \GO_1 \vd B'}{f''}
    }
  }
  }
  \end{array}
\end{equation}
Assuming given interpolant triples for the derivations $f$, $f'$ and $f''$:
\[
\begin{array}{l}
(D , g : D , \GD_1 \vd A , h : \GD_0 \vd D)
\\[3pt]
 (E , g' : \GG , E \vd A' , h' : B , \GL \vd E)
\\[3pt]
 (F , g'' : F , \GO_1 \vd B' , h'' : \GO_0 \vd F)
%  (D ,& g : D , \GD_1 \vd A ,& h : \GD_0 \vd D)
% \\[3pt]
%  (E ,& g' : \GG , E \vd A' ,& h' : B , \GL \vd E)
% \\[3pt]
%  (F ,& g'' : F , \GO_1 \vd B' ,& h'' : \GO_0 \vd F)
% & f' 
% & f''
% \\
% \hline
% D & E & F
% \\
% \hline
% g : D , \GD_1 \vd A & g' : \GG , E \vd A' & g'' : F , \GO_1 \vd B'
% \\
% \hline
% h : \GD_0 \vd D & h' : B , \GL \vd E & h'' : \GO_0 \vd F
\end{array}
\]
When running the interpolation procedure on the derivations in (\ref{eq:ct:example}), we obtain the following interpolant triples:
\[
\begin{array}{lr}
\arraycolsep=20pt
  % \begin{array}{c}
  %   (D \Rarr E) \ot F
  %   \\
  %   \tl \ (\tr \ (\Rl \ (h , g') , g'')) : \GG , \GD_0 , (D \Rarr E) \ot F , \GO_1 \vd A' \ot B'
  %   \\
  %   \tr\ (\Rr \ (\Rl \ (g , h')), h'') : \GD_1 , A \Rarr B , \GL , \GO_0 \vd (D \Rarr E) \ot F
  % \end{array}
  % \\[0.5cm]
  % \begin{array}{c}
  %   D \Rarr (E \ot F)
  %   \\
  %   \Rl \ (h , \tl \ (\tr \ (g' , g''))) : \GG , \GD_0 , D \Rarr (E \ot F) , \GO_1 \vd A' \ot B'
  %   \\
  %   \Rr \ (\Rl \ (g , \tr \ (h' , h''))) : \GD_1 , A \Rarr B , \GL , \GO_0 \vd D \Rarr (E \ot F)
  % \end{array}
  \begin{array}{c}
    \text{(for the left-hand-side)}
    \\
    (D \Rarr E) \ot F
    \\
    g_0 = \tl \ (\tr \ (\Rl \ (h , g') , g'')) 
    \\
    h_0 = \tr\ (\Rr \ (\Rl \ (g , h')), h'')
  \end{array}
  &
  \begin{array}{c}
    \text{(for the right-hand-side)}
    \\
    D \Rarr (E \ot F)
    \\
    g_1 : \Rl \ (h , \tl \ (\tr \ (g' , g'')))
    \\
    h_1 : \Rr \ (\Rl \ (g , \tr \ (h' , h'')))
  \end{array}
\end{array}
\]
The two interpolant formulae $(D \Rarr E) \ot F$ and $D \Rarr (E \ot F)$ are not logically equivalent.
The left one entails the right one, but not the other way round.
%and in fact there is only one way of derivability, i.e.\ $t = \Rr \ (\tl \ (\tr \ (\Rl \ (\ax , \ax),\ax)))$.
% The two interpolant formulae are not logically equivalent and in fact there is only one way of derivability (notice that the derivation is not unique)
% \begin{equation}\label{eq:t:example}
%   \proofbox{
%     \infer[\Rr]{(D \Rarr E) \ot F \vd D \Rarr (E \ot F)}{
%     \infer[\tl]{D , (D \Rarr E) \ot F \vd E \ot F}{
%       \infer[\tr]{D , D \Rarr E , F \vd E \ot F}{
%         \infer[\Rl]{D , D \Rarr E \vd E}{
%           \infer[\ax]{D \vd D}{}
%           &
%           \infer[\ax]{E \vd E}{}
%         }
%         &
%         \infer[\ax]{F \vd F}{}
%       }
%     }
%   }
%   }
% \end{equation}
The example leads to a relaxed notion of equivalence on interpolant triples for \L.
\begin{definition}\label{def:equiv:intrp:triples}
  Equivalence of interpolant triples, written $(D , g , h) \sim (D' , g' , h')$,  is the symmetric-transitive closure of the following relation: 
%  Two interpolant triples $(D , g , h)$ and $(D' , g' , h')$ are equivalent, denoted as $(D , g , h) \sim (D' , g' , h')$, if
%  \begin{itemize}
  %    \item
  there exists a derivation $t : D \vd D'$, such that $g \circeq \cut \ (t , g')$ and $\cut \ (h , t) \circeq h'$.
  %or
%    \item there exists a derivation $t : D' \vd D$, such that $g' \circeq \cut \ (t , g)$ and $\cut \ (h' , t) \circeq h$.
%  \end{itemize}
\end{definition}
Intuitively, two interpolant triples are equivalent if there exists a ``zig-zag'' of proofs of the form
$$
t_1: D \vdash D_1 \quad t_2 : D_2 \vdash D_1 \quad t_3 : D_2 \vdash D_3,
\quad
\dots
\quad
t_n : D_n \vdash D'
$$
and the derivations $g$ and $g'$, as well as $h$ and $h'$, are $\circeq$-related modulo composition with the $t_i$s.

We can check that derivations in (\ref{eq:ct:example} have equivalent interpolant triples.
Take $t = \Rr \ (\tl \ (\tr \ (\Rl \ (\ax , \ax),\ax))$ proving the sequent $(D \Rarr E) \ot F \vd D \Rarr (E \ot F)$.
We can prove that $\cut \ (t , g_1) \circeq g_0$ and $\cut \ (h_0 , t) \circeq h_1$:
\[
\begin{array}{lr}
  \cut \ (t,g_1) &
  \\
  = \cut \ (\Rr \ (\tl \ (\tr \ (\Rl \ (\ax , \ax) , \ax))), \Rl \ (h , \tl \ (\tr \ (g' , g'')))) &
    \\ & \hspace*{-0.5cm}\text{(unfold defns)}
%    \\
%    = \cut \ (h , \cut \ (\tl \ (\tr \ (\Rl \ (\ax , \ax) , \ax)) , \tl \ (\tr \ (g' , g'')))) &
%    \\ & \hspace*{-2cm}\text{(by definition of $\cut$)}
%    \\
%    = \cut \ (h , \tl \ (\cut \ (\tr \ (\Rl \ (\ax , \ax) , \ax) , \tl \ (\tr \ (g' , g''))))) &
%    \\ & \hspace*{-2cm}\text{(by definition of $\cut$)}
    \\
    = \cut \ (h , \tl \ (\cut \ (\Rl \ (\ax , \ax), \cut \ (\ax , \tr \ (g' , g''))))) &
    \hspace*{-0.5cm}\text{(defn of $\cut$)}
% \text{(by definition of $\cut$)}
    \\
    \circeq \cut \ (h , \tl \ (\cut \ (\Rl \ (\ax , \ax), \tr \ (g' , g'')))) &
     \hspace*{-0.5cm}\text{(Lemma \ref{lem:left:rules:cut})}
    \\
    = \cut \ (h , \tl \ (\tr \ (\cut \ (\Rl \ (\ax , \ax) , g') , g''))) &
     \hspace*{-0.5cm}\text{(defn of $\cut$)}
    \\
    \circeq \cut \ (h , \tl \ (\tr \ (\Rl \ (\ax , \cut \ (\ax , g')) , g''))) &
     \hspace*{-0.5cm}\text{(Lemma \ref{lem:left:rules:cut})}
    \\
    \circeq \cut \ (h , \tl \ (\tr \ (\Rl \ (\ax , g') , g''))) &
     \hspace*{-0.5cm}\text{(Lemma \ref{lem:left:rules:cut})}
%    \\
%    = \tl \ (\tr \ (\Rl \ (\cut \ (h , \ax) , g'), g'')) &
%     \text{(definition of $\cut$)}
    \\
    = \tl \ (\tr \ (\Rl \ (h , g'), g'')) &
     \hspace*{-0.5cm}\text{(defn of $\cut$)}
    \\
    = g_0 &
    \hspace*{-0.5cm}\text{(unfold defn)}
  \end{array}
\]
\[
\begin{array}{lr}
  \cut \ (h_0,t) &
  \\
  = \cut \ (\tr \ (\Rr \ (\Rl \ (g , h')) , h'') , \Rr \ (\tl \ (\tr \ (\Rl \ (\ax , \ax) , \ax)))) &
  \\ & \hspace*{-2cm}\text{(unfold defns)}
%    % \\ & \hspace*{-2cm}\text{(by definition of $\cut$)}
%    \\
%    = \Rr \ (\cut \ (\tr \ (\Rr \ (\Rl \ (g , h')) , h'')  , \tl \ (\tr \ (\Rl \ (\ax , \ax) , \ax)))) &
%    \\ & \hspace*{-2cm}\text{(by definition of $\cut$)}
%    \\
%    = \Rr \ (\cut \ (\Rr \ (\Rl \ (g , h')) , \cut \ (h'' , \tr \ (\Rl \ (\ax , \ax), \ax)))) &
%    \\ & \hspace*{-2cm}\text{(by definition of $\cut$)}
%    \\
%    = \Rr \ (\cut \ (\Rr \ (\Rl \ (g , h')) , \tr \ (\cut \ (\Rl \ (\ax , \ax) , \cut \ (h'' , \ax))))) &
%    \\ & \hspace*{-2cm}\text{(by definition of $\cut$)}
%    \\
%    = \Rr \ (\cut \ (\Rr \ (\Rl \ (g , h')) , \tr \ (\cut \ (\Rl \ (\ax , \ax) , h'')))) &
%    \\ & \hspace*{-2cm}\text{(by definition of $\cut$)}
%    \\
%    = \Rr \ (\tr \ (\cut \ (\Rr \ (\Rl \ (g , h')) , \Rl \ (\ax , \ax)), h'')) %&
%  \hspace*{0.5cm}\text{(defn of $\cut$)}
%    \hspace*{0.5cm}\text{(by definition of $\cut$)}
%   \\
%    = \Rr \ (\tr \ (\cut \ (\ax , \cut \ (\Rl \ (g , h') , \ax)) , h'')) &
%    \hspace*{0.5cm}\text{(by definition of $\cut$)}
   \\
    = \Rr \ (\tr \ (\cut \ (\ax , \Rl \ (g , h')) , h'')) &
    \hspace*{-2cm}\text{(defn of $\cut$)}
    \\
    =\Rr \ (\tr \ (\Rl \ (g , h')) , h'') &
    \hspace*{-2cm}\text{(Lemma \ref{lem:left:rules:cut})}
    \\
    \circeq \Rr \ (\Rl \ (g , \tr \ (h' , h''))) &
    \hspace*{-2cm}\text{(permut conversion)}
    \\
    = h_1 &
    \hspace*{-2cm}\text{(unfold defn)}
  \end{array}
\]
\begin{theorem}[Well-definedness of \MIP]\label{thm:welldef:L}
  For any two derivations $f , f' : \GG , \GD , \GL \vd C$ and their interpolant triples $(D , g , h)$ and $(D' , g' , h')$, if $f \circeq f'$, then $(D , g , h) \sim (D' , g' , h')$.
\end{theorem}
\begin{proof}
  Proof proceeds by examining all equations in the equivalence relation $\circeq$.
  We show the case of the equation that two instances of $\Rl$ are commutative (\ref{eq:rl:comm}) while other cases are similar.
  The cases are divided into three groups:
  \begin{enumerate}
    \item The interpolant context is ($i$) contained in $\GG$, $\GD_0$, $\GL$, $\GD_1$, or $\GO$, ($ii$) it contains $\GD_0 , A\Rarr B$ but not $\GD_1 , A' \Rarr B'$ and the other way around or ($iii$) it contains $\GD_0 , A \Rarr B , \GL , \GD_1 , A' \Rarr B'$. 
    % \begin{itemize}
    %   \item contained in $\GG$, $\GD_0$, $\GL$, $\GD_1$, or $\GO$ or
    %   \item it contains $\GD_0 , A\Rarr B$ but not $\GD_1 , A' \Rarr B'$ and the other way around or
    %   \item it contains $\GD_0 , A \Rarr B , \GL , \GD_1 , A' \Rarr B'$. 
    % \end{itemize}
    The interpolant triples of the two derivations in the equation are dictated by one of the derivations in $f$, $f'$ and $f''$. The triples will have the same interpolant formulae and the equivalence of derivations are witnessed by the equations in $\circeq$.
    For example, if the interpolant context is contained in $\GD_0$, then the interpolant triples are $(D , \Rl \ (g,\Rl\ (f' , f'')) , h)$ and $(D , \Rl \ (f' , \Rl \ (g , f'')) , h)$ where $(D , g ,h)$ is the interpolant triple of $f$. The interpolant formulae and derivation $h$ are the same and $\Rl \ (g,\Rl\ (f' , f'')) \circeq \Rl \ (f' , \Rl \ (g , f''))$ is an instance of the commutativity of $\Rl$. Therefore, the two interpolant triples are equivalent. 
    \item The interpolant context splits ($i$) $\GG$ and $\GD_0$, ($ii$) $\GG$ and $\GD_1$, ($iii$) $\GD_0$ and $\GL$, ($iv$) $\GD_0$ and $\GO$, ($v$) $\GL$ and $\GD_1$, or ($vi$) $\GD_1$ and $\GO$.
    % \begin{itemize}
    %   \item $\GG$ and $\GD_0$, %(tensor of $f$ and $f''$), 
    %   \item $\GG$ and $\GD_1$, %($\Rarr$ of $f'$ and $f''$),
    %   \item $\GD_0$ and $\GO$, %($\Rarr$ of $f$ and $f''$),
    %   \item $\GL$ and $\GD_1$, or %(tensor of $f'$ and $f''$) or
    %   \item $\GD_1$ and $\GO$. %($\Rarr$ of $f'$ and $f''$)
    % \end{itemize}
    In these cases, the interpolant triples of the two derivations in the equation is dictated by two of the derivations in $f$, $f'$ and $f''$.
    Again, the triples will have the same interpolant formulae and the equivalence of derivations are witnessed by the equations in $\circeq$.
    For example, if the interpolant context splits $\GG$ and $\GD_1$, then the interpolant triples of the derivations in the equation are dictated only by $f'$ and $f''$. Assume that the interpolant triples of $f'$ and $f''$ are $(E , g' , h')$ and $(F , g'' , h'')$, respectively.
    The interpolant triples of derivations in the equation are:
    \[
    \begin{array}{l}
      (F \ot E , \tl \ (\Rl \ (g' , g'')) , \Rl \ (f , \tr\ (h' , h''))) 
      \\
      % \text{and}
      % \\
      (F \ot E , \tl \ (\Rl \ (g' , g'')) , \tr \ (h' , \Rl \ (f , h'')))
    \end{array}
    \] 
    % The interpolant formulae and the derivation $\tl \ (\Rl \ (g' , g''))$ are the same and 
    The equation $\Rl \ (f , \tr\ (h' , h'')) \circeq \tr \ (h' , \Rl \ (f , h''))$ is an instance of permutation between $\Rl$ and the second premise of $\tr$. Therefore, the two interpolant triples are equivalent.
    % splits $\GG$ and $\GD_0$ (tensor of $f$ and $f''$), splits $\GD_0$ and $\GL$ ($\Rarr$ of $f$ and $f''$), splits $\GD_0$ and $\GO$, ($\Rarr$ of $f$ and $f''$), splits $\GL$ and $\GD_1$ (tensor of $f'$ and $f''$), splits $\GD_1$ and $\GO$ ($\Rarr$ of $f'$ and $f''$)
    \item The last one is the interpolant context splits $\GD_0$ and $\GD_1$, i.e. the interpolant context is $\GD''_0 , A \Rarr B , \GL , \GD'_1$ where $\GD_0 = \GD'_0 , \GD''_0$, $\GD_1 = \GD'_1 , \GD''_1$. Similar to the case for (\ref{eq:ct:example}), we first run the interpolation procedure to the left and right derivations in the equation to obtain the following data:
    \[
      \begin{array}{rl}
      \begin{array}{r}
        \text{(interpolant triples}
        \\
        \text{of $f$, $f'$, and $f''$)}
      \end{array}
      &
      \begin{array}{l}
        (D , g : D , \GD''_0 \vd A , h : \GD'_0 \vd D)
      \\[3pt]
      (E , g' : E , \GD''_1 \vd A' , h' : \GD'_1 \vd E)
      \\[3pt]
      (F , g'' : \GG , F , B' , \GO \vd C , h'' : B , \GL \vd F)
      \end{array}
      % & f' 
      % & f''
      % \\
      % \hline
      % D & E & F
      % \\
      % \hline
      % g : D , \GD_1 \vd A & g' : \GG , E \vd A' & g'' : F , \GO_1 \vd B'
      % \\
      % \hline
      % h : \GD_0 \vd D & h' : B , \GL \vd E & h'' : \GO_0 \vd F
      \end{array}
    \]
    \[
      \begin{array}{lr}
      \arraycolsep=20pt
        \begin{array}{c}
          \text{(for the top derivation)}
          \\
          D \Rarr (F \ot E)
          \\
          \Rl (h , \tl \ (\Rl \ (g' , g'')))
          \\
          \Rr \ (\Rl \ (g , (\tr \ (h'' , h'))))
        \end{array}
        &
        \begin{array}{c}
          \text{(for the bottom derivation)}
          \\
          (D \Rarr F) \ot E
          \\
          \tl \ (\Rl \ (g' , \Rl (h , g'')))
          \\
          \tr \ (\Rr \ (\Rl \ (g , h'')), h')
        \end{array}
      \end{array}
    \]
    The two interpolant formulae are not logically equivalent but there exists a derivation $\Rr \ (\tl \ (\tr \ (\Rl \ (\ax , \ax),\ax))) : (D \Rarr F) \ot E \vd D \Rarr (F \ot E)$ such that the following two equations hold:
    % We then check the equivalence of derivations. The first case is:
    % \[
    %   \begin{array}{lr}
    %     \cut \ (\Rr \ (\tl \ (\tr \ (\Rl \ (\ax , \ax),\ax))) , \Rl (h , \tl \ (\Rl \ (g' , g'')))) &
    %     \\
    %     hi
    %   \end{array}
    % \]
    \[
    \begin{array}{l}
      \tl \ (\Rl \ (g' , \Rl (h , g''))) 
      \\
      \hspace*{1.4cm} \circeq \cut \ (\Rr \ (\tl \ (\tr \ (\Rl \ (\ax , \ax),\ax))) , \Rl (h , \tl \ (\Rl \ (g' , g''))))
      \\[5pt]
      \cut\ (\tr \ (\Rr \ (\Rl \ (g , h'')), h') , \Rr \ (\tl \ (\tr \ (\Rl \ (\ax , \ax),\ax)))) 
      \\
      \hspace*{1.4cm} \circeq  \Rr \ (\Rl \ (g , (\tr \ (h'' , h'))))
    \end{array}
    \]
    The chains of reasoning are similar to the ones in the proof of equivalence of interpolant triples of (\ref{eq:ct:example}).
  \end{enumerate} 
\end{proof}

%\section{Proof-relevant Maehara Multi-Interpolation of Product-free Lambek Calculus}
\section{The Story in Product-free Lambek Calculus}
In this section, we show that the product-free Lambek calculus (\LPfree) also enjoys a proof-relevant, well-defined interpolation procedure.
The main difference from the the situation in the presence of products is that \LPfree\ \emph{does not} enjoy Maehara interpolation.
The reason is visible in the proof of Theorem \ref{thm:MIP}: in the first of the two cases we consider, the interpolant formula is a product $E \ot D$.
But Craig interpolation still holds, since it is possible to prove a generalized \emph{Maehara multi-interpolation} property first described by Pentus \cite{Pentus1997}. 

Before stating the multi-interpolation property, let us recall some definitions and introduce some auxiliary results.
\LPfree\ is obtained from \L\ by excluding the connective ${\ot}$,  inference rules $\tl$ and $\tr$ and all generating equations in $\circeq$ containing instances of $\ot$ and its introduction rules.
Clearly cut is admissible in \LPfree, the proof is just a subproof of Theorem \ref{thm:cut}.
%\begin{theorem}[Cut admissibility for \LPfree]\label{thm:cut:LPfree}
%  The cut rule
%  \[
%  \infer[\cut]{\GG , \GD , \GL \vd C}{
%    \deduce{\GD \vd A}{f}
%    &
%    \deduce{\GG , A , \GL \vd C}{g}
%  }
%  \]
%   is admissible in \LPfree.
%\end{theorem}
%The proof is a sub proof of the one of Theorem \ref{thm:cut}

Here are three admissible rules that will be employed later in the section. 
First, given a list of formulae $\GD = A_1, \dots, A_n$, we define an iterated version of the rule $\Rr$.
We write $\GD \Rarr^* B$ for the formula $A_n \Rarr (A_{n-1} \Rarr (\dots (A_1 \Rarr B)\dots))$.
The double-lines denote equality of sequents.
\begin{equation*}
  \begin{array}{c}
    \proofbox{
      \infer[\Rsr]{\GG \vd \GD \Rs B}{
        \GD , \GG \vd B
      }
    }
    \quad=
    \proofbox{
      \infer={\GG \vd \GD \Rs B}{
        \infer[\Rr]{\GG \vd A_n \Rarr (A_{n-1} \Rarr (\dots (A_1 \Rarr B)\dots))}{
          \deduce[\vdots]{A_n , \GG \vd A_{n-1} \Rarr (\dots (A_1 \Rarr B)\dots)}{
              \infer[\Rr]{A_2 , \dots , A_n , \GG \vd A_1 \Rarr B}{
                \infer={A_1 , A_2 , \dots , A_n , \GG \vd B}{
                  \GD , \GG \vd B
                }
              }
          }
        }
      }
    }
  \end{array}
\end{equation*} 
Notice that $\Rsr \ f = f$ if $\GD$ is empty.
Second, given a list of derivations $f_i : \GD_i \vd A_i$ for $i \in \{1,\dots, n\}$ we define an iterated version of $\Rl$ consisting of $n$ consecutive applications of the rule:
\begin{equation*}
  \begin{array}{l}
    \proofbox{
      \infer[\Rsl]{\GG, \GD_1 , \dots , \GD_n , \GD \Rs B,\GL \vd C}{
%        \deduce{[\GD_i \vd A_i]}{[f_i]}
        [\GD_i \vd A_i]
        &
        \GG , B , \GL \vd C
%        \deduce{\GG , B , \GL \vd C}{g}
      }
    }
    \\
    \hspace*{0.5cm}=\quad
    \proofbox{
      \infer={\GG, \GD_1 , \dots , \GD_n , \GD \Rs B,\GL \vd C}{
        \infer[\Rl]{\GG, \GD_1 , \dots , \GD_n , A_n \Rarr (A_{n-1} \Rarr (\dots (A_1 \Rarr B)\dots)),\GL \vd C}{
%          \deduce{\GD_n \vd A_n}{f_n}
          \GD_n \vd A_n
          &
          \deduce[\vdots]{\GG, \GD_1 , \dots , \GD_{n-1} , A_{n-1} \Rarr (\dots (A_1 \Rarr B)\dots),\GL \vd C}{
            \infer[\Rl]{\GG , \GD_1 , A_1 \Rarr B , \GL \vd C}{
%              \deduce{\GD_1 \vd A_1}{f_1}
              \GD_1 \vd A_1
              &
%              \deduce{\GG , B , \GL \vd C}{g}
              \GG , B , \GL \vd C
            }
          }
        }
      }
    }
  \end{array}
\end{equation*}
Notice that $\Rsl \ ([~] , g) = g$.
%Both admissible rules can be similarly defined for the other implication $\Larr$.
Given $\GD = A_1, \dots, A_n$, we similarly write $B \Larr^* \GD$ for the formula $((\dots(B \Larr A_n) \dots) \Larr A_2) \Larr A_1$.
The definitions of $\Lsr$ and $\Lsl$ are similar to $\Rsr$ and $\Rsl$.
% Given the same list of formulae $\GD$, we can define an iterated version of $\Lr$ similarly as above.. We write $B \Larr^* \GD$ for the formula $((\dots(B \Rarr A_n) \dots) \Larr A_2) \Larr A_1$.
% \[
%   \proofbox{\infer[\Lsr]{\GG \vd B \Ls \GD}{
%     \deduce{\GG , \GD \vd B}{f}
%   }}
%   \quad=
%   \proofbox{
%     \infer={\GG \vd B \Ls \GD}{
%         \infer[\Lr]{\GG \vd ((\dots(B \Rarr A_n) \dots) \Larr A_2) \Larr A_1}{
%           \deduce[\vdots]{\GG, A_1 \vd (\dots(B \Rarr A_n) \dots) \Larr A_2}{
%               \infer[\Lr]{\GG, A_1 , \dots , A_{n-1} \vd B \Larr A_n}{
%                 \infer={\GG , A_1 , \dots , A_{n-1},A_n \vd B}{
%                   \deduce{\GG, \GD \vd B}{f}
%                 }
%               }
%           }
%         }
%       }
%   }
% \]

Next, given a list of derivations, $f_i : \GD_i \vd A_i$ for $i \in \{1,\dots, n\}$ and a derivation $g : \GG , A_1, \dots, A_n, \GL \vd C$, we define an iterated version of $\cut$ consisting of $n$ applications of the rule on distinct formulae in the context of $g$:
\begin{equation*}
  \begin{array}{l}
    \proofbox{
      \infer[\cuts]{\GG , \GD_1 , \dots , \GD_n , \GL \vd C}{
        \deduce{[\GD_i \vd A_i]}{[f_i]}
        &
        \deduce{\GG , A_1, \dots, A_n, \GL \vd C}{g}
      }
    }
    \\
    \hspace*{3cm}=\quad
    \proofbox{
      \infer[\cut]{\GG , \GD_1 , \dots , \GD_n , \GL \vd C}{
      \deduce{\GD_1 \vd A_1}{f_1}
      &
      \deduce[\vdots]{\GG , A_1 , \GD_2 , \dots , \GD_n , \GL \vd C}{
        \infer[\cut]{\GG , A_1 , \dots , A_{n-1} , \GD_n , \GL \vd C}{
          \deduce{\GD_n \vd A_n}{f_n}
          &
          \deduce{\GG , A_1, \dots, A_n, \GL \vd C}{g}
        }
      }
    }
    }
  \end{array}
\end{equation*}
Moreover, the following equations, establishing a form of associativity and commutativity of $\cut$, are provable in \LPfree\ (and also in \L).
Their proof proceeds by structural induction on derivations, following the cut admissibility procedure.
%due to the cut admissibility procedure defined in Theorems \ref{thm:cut} and \ref{thm:cut:LPfree}.
\begin{equation}\label{eq:cut:assoc}
  \begin{array}{l}
    \proofbox{
      \infer[\cut]{\GG' , \GG , \GD , \GL , \GL' \vd C}{
        \infer[\cut]{\GG,\GD,\GL \vd B'}{
          \deduce{\GD \vd B}{f}
          &
          \deduce{\GG , B , \GL \vd B'}{g}
        }
        &
        \deduce{\GG' , B' , \GL' \vd C}{h}
      }
    }
    \\
    \hspace*{3.5cm}=\quad
    \proofbox{
      \infer[\cut]{\GG' , \GG , \GD , \GL , \GL' \vd C}{
        \deduce{\GD \vd B}{f}
        &
        \infer[\cut]{\GG',\GG,B,\GL',\GL \vd B'}{
          \deduce{\GG , B , \GL \vd B'}{g}
          &
          \deduce{\GG' , B' , \GL' \vd C}{h}
        }
      }
    }
  \end{array}
\end{equation}
\begin{equation}\label{eq:cut:comm}
  \begin{array}{l}
    \proofbox{
      \infer[\cut]{\GG , \GD , \GL , \GD' , \GO \vd C}{
        \deduce{\GD \vd B}{f}
        &
        \infer[\cut]{\GG , B , \GL , \GD' , \GO \vd C}{
          \deduce{\GD' \vd B'}{f'}
          &
          \deduce{\GG , B , \GL , B' , \GO \vd C}{g}
        }
      }
    }
    \\
    \hspace*{3.5cm}=\quad
    \proofbox{
      \infer[\cut]{\GG , \GD , \GL , \GD' , \GO \vd C}{
        \deduce{\GD' \vd B'}{f'}
        &
        \infer[\cut]{\GG , \GD , \GL , B' , \GO \vd C}{
          \deduce{\GD \vd B}{f}
          &
          \deduce{\GG , B , \GL , B' , \GO \vd C}{g}
        }
      }
    }
  \end{array}
\end{equation}
%The first equation is the associativity of $\cut$ and the second one is the commutativity of $\cut$.
\begin{theorem}[Maehara multi-interpolation for \LPfree\ \cite{Pentus1997}]\label{thm:MIP:LPfree}
~
\\
  Given a derivation $f : \GG , \GD , \GL \vd C$, there exist a partition $\langle \GD_1, \dots, \GD_n\rangle$ of $\GD$, a list of formulae $[D_i]$ for $i\in\{1,\dots,n\}$ a derivation $g : \GG, [D_i], \GL \vdash C$ and a list of derivations $[h_i : \GD_i \vdash D_i]$ such that $\vars{D_1 , \dots, D_n} \subseteq \vars{\GD} \cap \vars{\GG, \GL, C}$.
\end{theorem}
\begin{proof}
  Proof proceeds similarly as the proof of Theorem \ref{thm:MIP}.
  Here we briefly discuss how the new proofs of the two interesting cases of $f = \Rl \ (f' , f'') : \GG' , \GD' , A \Rarr B , \GL' \vd C$.
  The first case is when the interpolant context splits $\GG'$ and $\GD'$ where the interpolant formula was a tensor formula. 
  In this case, we apply inductive hypothesis on $f'$ and $f''$ respectively to obtain:
  \begin{itemize}
    \item a partition $\langle \GD'_{01}, \dots , \GD'_{0n}\rangle$ of $\GD'_0$ and a list of formulae $[D_i]$ for $i\in\{1,\dots,n\}$,
    \item a derivation $g' : [D_i] , \GD'_1 \vd A$, a list of derivations $[h'_i : \GD'_{0i} \vdash D_i]$ such that
    \item $\vars{D_1 , \dots, D_n} \subseteq \vars{\GD'_0} \cap \vars{\GD'_1, A}$
  \end{itemize}
  \begin{itemize}
    \item a partition $\langle \GG'_{11}, \dots , \GG'_{1m}\rangle$ of $\GG'_1$ and a list of formulae $[E_j]$ for $j\in\{1,\dots,m\}$,
    \item a derivation $g'' : \GG'_0 , [E_j], B , \GL' \vd A$, a list of derivations $[h''_j : \GG'_{1j} \vdash E_j]$ such that
    \item $\vars{E_1 , \dots, E_m} \subseteq \vars{\GG'_1} \cap \vars{\GG'_0 , B , \GL' , C}$
  \end{itemize}
  The desired partition of $\GG'_1, \GD'_0$ is $\langle \GG'_{11}, \dots , \GG'_{1m}, \GD'_{01}, \dots , \GD'_{0n}\rangle$ and the list of interpolant formulae is $[E_1 , \dots, E_m, D_1,\dots, D_n]$. The desired derivations are \linebreak $\Rl \ (g' , g'')$ and $[h''_1, \dots, h''_m, h'_1, \dots, h'_n]$.
  The variable condition is easy to check.

  The second case is when the interpolant context splits both $\GD'$ and $\GL'$ and contains $A \Rarr B$. By inductive hypothesis, we obtain:
  \begin{itemize}
    \item a partition $\langle \GD'_{01}, \dots , \GD'_{0n}\rangle$ of $\GD'_0$ and a list of formulae $[D_i]$ for $i\in\{1,\dots,n\}$,
    \item a derivation $g' : [D_i] , \GD'_1 \vd A$, a list of derivations $[h'_i : \GD'_{0i} \vdash D_i]$ such that
    \item $\vars{D_1 , \dots, D_n} \subseteq \vars{\GD'_0} \cap \vars{\GD'_1, A}$
  \end{itemize}
  \begin{itemize}
    \item a partition $\langle \GL'_{01}, \dots , \GL'_{0m}\rangle$ of $\GL'_0$, where $\GL'_{01} = B , \GL''_{01}$ for some $\GL''_{01}$ and a list of formulae $[E_j]$ for $j\in\{1,\dots,m\}$,
    \item a derivation $g'' : \GG' , [E_j], \GL'_1 \vd A$, a list of derivations $[h''_j : \GL'_{0j} \vdash E_j]$ such that
    \item $\vars{E_1 , \dots, E_m} \subseteq \vars{\GG'_1} \cap \vars{\GG,  \GL'_1 , C}$
  \end{itemize}
  The desired partition of $\GD'_1 , A \Rarr B , \GL'_1$ is $\langle (\GD'_1, A \Rarr B , \GL''_{01}), \GL'_{02}, \dots \GL'_{0m}\rangle$ and the list of interpolant formulae is $[[D_i] \Rs E_1 , E_2 , \dots , E_j]$. The desired derivations are $\Rsl \ ([h'_i] , g'')$ and $[\Rsr \ (\Rl \ (g' , h''_1)), h''_2, \dots , h''_m]$.
  The variable condition is easy to check.
\end{proof}
\begin{theorem}[Proof-relevant multi-interpolation for \LPfree]\label{thm:cut:intrp:LPfree}
~
\\
  For derivations $g : \GG , D_1, \dots, D_n , \GL \vd C$ and $h_i : \GD \vd D$ for $i \in \{1 ,\dots, n\}$ obtained by interpolating the derivation $f : \GG , \GD , \GL \vd C$, $\cuts \ ([h_i] , g) \circeq f$.
\end{theorem}
\begin{proof}
  Proof proceeds by induction on $f$.
  We show one interesting subcase of $f = \Rl \ (f' , f'') : \GG' , \GD' , A \Rarr B , \GL' \vd C$ that the interpolation context splits both $\GD'$ and $\GL'$ and contains $A \Rarr B$.
  Recall the derivations are $\Rsl \ ([h'_i] , g'')$ and $[\Rsr \ (\Rl \ (g' , h''_1)), h''_2, \dots , h''_m]$.
  The desired equation is obtained by the following:
  \[
    \begin{array}{lr}
      \cuts \ ([\Rsr \ (\Rl \ (g' , h''_1)), h''_2, \dots , h''_m], \Rsl \ ([h'_i] , g''))
      &
      \\
      =\cuts \ ([h''_2,\dots,h''_m] , \cut \ (\Rsr \ (\Rl \ (g',h''_1), \Rsl \ ([h'_i],g'')))) 
      &
      \\
      &\hspace*{-1cm}\text{(by (\ref{eq:cut:comm}))}
      \\
      =\cuts \ ([h''_2,\dots,h''_m] , \cuts \ ([h'_i], \cut \ (\Rl \ (g' , h''_1), g''))) & \hspace*{-1cm}\text{(by definition of $\cut$)}
      \\
      \circeq \cuts \ ([h''_2,\dots,h''_m] , \cuts \ ([h'_i],\Rl \ (g' , \cut \ (h''_1,g''))))& \hspace*{-1cm}\text{(by Lemma \ref{lem:left:rules:cut})}
      \\
      = \cuts \ ([h''_2,\dots,h''_m] ,\Rl \ (\cuts \ ([h'_i],g'), \cut \ (h''_1,g'')))& \hspace*{-1cm}\text{(by definition of $\cut$)}
      \\
      \circeq \cuts \ ([h''_2,\dots,h''_m] ,\Rl \ (f', \cut \ (h''_1,g'')))& \hspace*{-1cm}\text{(by ind. hyp. on $f'$)}
      \\
      = \Rl \ (f' , \cuts ([h''_j], g'')) &\hspace*{-1cm}\text{(by definition of $\cut$}
      \\
      &\hspace*{-1cm}\text{and (\ref{eq:cut:comm}))}
      \\
      \circeq \Rl \ (f' , f'')&\hspace*{-1cm}\text{(by ind. hyp. on $f''$)}
    \end{array}
  \]
  Other cases are similar.
  % \[
  % \cuts ([\Rsr \ (\Rl \ (g' , h''_1)), h''_2, \dots , h''_m], \Rsl \ ([h'_i] , g'')) \circeq \Rl \ (f' , f'').
  % \]
\end{proof}
The data of \MmIP\ consist of a quadruple and their equivalence is defined by additionally considering the relationship between partitions.
\begin{definition}\label{def:equiv:intrp:triples:LPfree}
  Two interpolant quadruples $(\langle \GD_i\rangle , [D_i] , g , [h_i])$, $i \in \{1,\dots,n\}$ and $(\langle \GD'_j\rangle , [D'_j] , g' , [h'_j])$, $j \in \{1,\dots,m\}$ are equivalent, denoted as \\$(\langle \GD_i\rangle , [D_i] , g , [h_i]) \sim (\langle \GD'_j\rangle , [D'_j] , g' , [h'_j])$, if
  \begin{itemize}
    \item we can associate an additional subscript to each $\GD_i$ such that for any $\GD'_j$, $[ \GD_{ij} ] = \GD'_j$, i.e.\ $\langle\GD_i\rangle$ is a partition of $\langle\GD'_j\rangle$,
    \item for each $D'_j$, there exists a derivation $t_j : [ D_{ij} ]\vd D'_j$ such that 
    \begin{itemize}
      \item[--] $g \circeq \cuts \ ([t_j] , g')$ and 
      \item[--] $\cuts \ ([h_{ij}] , t_j) \circeq h'_j$ for each $h'_j$,
    \end{itemize}
    \item or the other way around.
  \end{itemize}
\end{definition}
\begin{theorem}[Well-definedness of \MmIP]\label{thm:welldef:LPfree}
  For any two derivations, $f,f' : \GG , \GD , \GL \vd C$ and their interpolant quadruples $(\langle \GD_i\rangle , [D_i] , g , [h_i])$, $i \in \{1,\dots,n\}$ and $(\langle \GD'_j\rangle , [D'_j] , g' , [h'_j])$, $j \in \{1,\dots,m\}$, if $f \circeq f'$, then $(\langle \GD_i\rangle , [D_i] , g , [h_i]) \sim (\langle \GD'_j\rangle , [D'_j] , g' , [h'_j])$.
\end{theorem}
\begin{proof}
  Proof proceeds by examining all equations in the equivalence relation $\circeq$.
  The case distinction for the equations in \LPfree\ is exactly the same as the proof of Theorem \ref{thm:welldef:L}.
  We show the most complicated case of the equation (\ref{eq:rl:ll:assoc}) where the interpolant context splits $\GG'$ and $\GD$, i.e.\ $\GG' = \GG'_0,\GG'_1$, $\GD = \GD_0, \GD_1$ and the interpolant context is $\GG'_1 , B' \Larr A', \GG , \GD_0$. By the interpolation procedure, we have
    \[
      \scalebox{1}{$\begin{array}{c}
      % \begin{array}{r}
      %   \text{(intrp. quadruples}
      %   \\
      %   \text{of $f$, $f'$, and $f''$)}
      % \end{array}
      % &
      \begin{array}{l}
        (\langle \GD'_{01},\dots,\GD'_{0n}\rangle, [D_i] , g : [D_i] , \GD''_0 \vd A , [h_i : \GD'_{0i} \vd D_i]), i \in \{1, \dots, n\}
      \\[3pt]
      (\langle \GL_{1}, \dots,\GL_{m}\rangle, [E_j] , g' : \GG, [E_j] \vd A' , [h'_j : \GL_j \vd E_j]), j \in\{1, \dots, m\}
      \\[3pt]
      (\langle \GG'_{11}, \dots, \GG'_{1l}\rangle,[F_k] , g'' : \GG'_0 , [F_k] , \GL' \vd C , [h''_l : \GG'_{1k} \vd F_k]), k \in \{1, \dots, l\}
      \end{array}
      % & f' 
      % & f''
      % \\
      % \hline
      % D & E & F
      % \\
      % \hline
      % g : D , \GD_1 \vd A & g' : \GG , E \vd A' & g'' : F , \GO_1 \vd B'
      % \\
      % \hline
      % h : \GD_0 \vd D & h' : B , \GL \vd E & h'' : \GO_0 \vd F
      \end{array}$}
    \]
where $\GL_1 = B , \GL'_1$ for some $\GL'_1$ and $\GG'_{1l} = \GG''_{1l} , B'$ for some $\GG''_{1l}$ and
  \[
      \begin{array}{c}
      % \arraycolsep=20pt
      \begin{array}{c}
          \text{(interpolation quadruple for $\Rl \ (f , \Ll \ (f',f''))$)}
          \\[3pt]
          (\langle \GG'_{11}, \dots, \GG'_{1l-1}, (\GG''_{1l} , B'\Larr A',\GG,\GD'_{01},\dots,\GD'_{0n})\rangle,
          \\[3pt]
          ~[F_1,\dots,F_{l-1}, F_l \Ls [[D_i] \Rs E_1,E_2,\dots,E_m]],
          \\[3pt]
          \Lsl \ ([\Rsr \ (\Rl \ (g, h'_1)), h'_2,\dots,h'_m], g'')
          \\[3pt]
          ~[h''_1, \dots, h''_{l-1}, \Lsr \ (\Ll \ (\Rsl\ ([h_i],g') , h''_l))])
        \end{array}
        \\[40pt]
        \begin{array}{c}
          \text{(interpolation quadruple for $\Ll \ (\Rl \ (f , f'), f'')$)}
          \\[3pt]
          (\langle \GG'_{11}, \dots, \GG'_{1l-1}, (\GG''_{1l} , B'\Larr A',\GG),\GD'_{01},\dots,\GD'_{0n}\rangle,
          \\[3pt]
          ~ [F_1, \dots, F_{l-1}, F_l \Ls [E_j] , D_1, \dots, D_n],
          \\[3pt]
          \Rl \ (g, \Rsl \ ([h'_j] , g'')),
          \\[3pt]
          ~[h''_1, \dots, h''_{l-1}, \Rsr \ (\Ll (g' , h''_l)) , h_1, \dots, h_n])
        \end{array}
      \end{array}
    \]
Notice that $\langle (\GG''_{1l} , B'\Larr A',\GG),\GD'_{01},\dots,\GD'_{0n}\rangle$ is a partition of\newline $(\GG''_{1l} , B'\Larr A',\GG,\GD'_{01},\dots,\GD'_{0n})$ and there exists a derivation:
\[
  \infer[\Lsr]{F_l \Ls [E_j], D_1, \dots, D_n \vd F_l \Ls [[D_i] \Rs E_1, E_2,\dots,E_m]}{
    \infer[\Rsl]{F_l \Ls [E_j], D_1, \dots, D_n, [D_i]\Rs E_1, E_2,\dots, E_m \vd F_l}{
      \infer{D_i \vd D_i}{[\ax]}
      &
      \infer[\Lsl]{F_l \Ls [E_j], E_1,\dots, E_m \vd F_l}{
        \infer{[E_j \vd E_j]}{[\ax]}
        &
        \infer[\ax]{F_l \vd F_l}{}
      }
    }
  }
\]
The other parts of the partitions can be ignored since they are exactly the same.

We then check the equivalence of derivations. The first cases is:
\[
  \begin{array}{lr}
    \cut\ (\Lsr \ (\Rsl \ ([\ax], \Lsl \ ([\ax], \ax))), \Rsl \ ([\Rsr \ (\Rl \ (g, h'_1)), h'_2,\dots,h'_m], g''))
    &
    \\
    = \cuts \ ([\Rsr (\Rl \ (g, h'_1)), \dots, h'_m], \cut\ (\Rsl\ ([\ax], \Lsl \ ([\ax],\ax)),g''))&
    \\
    &\hspace*{-3.5cm}\text{(by definition of $\cut$)}
    \\
    \circeq \cuts \ ([\Rsr (\Rl \ (g, h'_1)), \dots, h'_m], \Rsl \ ([\ax], \cut\ (\Lsl \ ([\ax], \ax),g'')))
    &
    \\
    &\hspace*{-3.5cm}\text{(by Lemma \ref{lem:left:rules:cut})}
    \\
    \circeq \cuts \ ([\Rsr (\Rl \ (g, h'_1)), \dots, h'_m],\Rsl\ ([\ax], \Lsl \ ([\ax], g'')))
    \\
    &\hspace*{-3.5cm}\text{(by Lemma \ref{lem:left:rules:cut})}
    \\
    = \cuts\ ([h'_2,\dots,h'_m], (\cut \ (\Rsr \ (\Rl \ (g,h'_1)), \Rsl \ ([\ax], \Lsl \ ([\ax], g'')))))
    &
    \\
    &\hspace*{-3.5cm}\text{(by (\ref{eq:cut:comm}))}
        \end{array}
\]
\[    
    \begin{array}{lr}
    \circeq \cuts\ ([h'_2,\dots,h'_m],\cut\ (\Rl \ (g, h'_1), \Lsl \ ([\ax], g'')))
    \\
    &\hspace*{-7cm}\text{(by definition of $\cut$ and Lemma \ref{lem:left:rules:cut})}
    \\
    = \cuts\ ([h'_2,\dots,h'_m],\Lsl \ ([\Rl \ (g, h'_1), \ax,\dots,\ax], g''))
    \\
    &\hspace*{-1cm}\text{(by definition of $\cut$)}
    \\
    = \Lsl \ ([\Rl \ (g, h'_1), h'_2,\dots,h'_m], g'') 
    &\hspace*{-1cm}\text{(by definition of $\cut$)}
    \\
    = \Ll \ (\Rl \ (g,h'_1) , \Lsl \ ([h'_2,\dots,h'_m],g''))
    &\hspace*{-1cm}\text{(by definition of $\Lsl$)}
    \\
    \circeq \Rl \ (g, \Ll \ (h'_1, \Lsl\ ([h'_2,\dots,h'_m],g'')))
    &\hspace*{-1cm}\text{(by (\ref{eq:rl:ll:assoc}))}
    \\
    = \Rl \ (g, \Lsl \ ([h'_j], g''))
    &\hspace*{-1cm}\text{(by definition of $\Lsl$)}
    % &\hspace*{-10cm}
  \end{array}
\]
The second case is:
\[
  \begin{array}{lr}
    \cuts \ ([\Lsr \ (\Rl \ (g', h''_l)), h_1,\dots,h_n],\Lsr \ (\Rsl \ ([\ax], \Lsl \ ([\ax], \ax))))
    &
    \\
    = \Lsr \ (\cuts \ ([\Lsr \ (\Rl \ (g', h''_l)), h_1,\dots,h_n], \Rsl \ ([\ax], \Lsl\ ([\ax], \ax))))
    &
    \\
    &\hspace*{-7cm}\text{(by definition of $\cut$)}
    \\
    = \Lsr \ (\Rsl \ ([h_i], \cut \ (\Lsr\ (\Ll \ (g', h''_l)), \Lsl \ ([\ax], \ax)))) 
    &
    \\
    &\hspace*{-7cm}\text{(by definition of $\cut$)}
    \\
    = \Lsr \ (\Rsl \ ([h_i], \cuts \ ([\ax], \Ll \ (g',h''_l))))
    & \hspace*{-7cm}\text{(by definition of $\cut$)}
    \\
    \circeq \Lsr \ (\Rsl \ ([h_i], \Ll \ (g', h''_l)))
    &\hspace*{-7cm}\text{(by Lemma \ref{lem:left:rules:cut})}
    \\
    \circeq \Lsr \ (\Ll \ (\Rsl \ ([h_i], g'),h''_l))
    &\hspace*{-7cm}\text{(by applying (\ref{eq:rl:ll:assoc}) $n$ times)}
  \end{array}
\]
Therefore the two interpolant quadruples are equivalent. Other cases are similar.
%% ax annotated
% \[
%   \infer[\Lsr]{F_l \Ls [E_j], D_1, \dots, D_n \vd F_l \Ls [[D_i] \Rs E_1, E_2,\dots,E_m]}{
%     \infer[\Rsl]{F_l \Ls [E_j], D_1, \dots, D_n, [D_i]\Rs E_1, E_2,\dots, E_m \vd F_l}{
%       \infer{D_i \vd D_i}{[\ax_{D_i}]}
%       &
%       \infer[\Lsl]{F_l \Ls [E_j], E_1,\dots, E_m \vd F_l}{
%         \infer{[E_j \vd E_j]}{[\ax_{E_j}]}
%         &
%         \infer[\ax_{F_l}]{F_l \vd F_l}{}
%       }
%     }
%   }
% \]
% The instances of $\ax$ are annotated with subscripts here to provide a better track of the reasoning to the equations below.

% We then check the equivalence of derivations. The first cases is:
% \[
%   \begin{array}{lr}
%     \cut\ (\Lsr \ (\Rsl \ ([\ax_{D_i}], \Lsl \ ([\ax_{E_j}], \ax_{F_l}))), \Rsl \ ([\Rsr \ (\Rl \ (g, h'_1)), h'_2,\dots,h'_m], g''))
%     &
%     \\
%     = \cuts \ ([\Rsr (\Rl \ (g, h'_1)), \dots, h'_m], \cut\ (\Rsl\ ([\ax_{D_i}], \Lsl \ ([\ax_{E_j}],\ax_{F_l})),g''))
%     &
%     \\
%     &\hspace*{-7cm}\text{(by definition of $\cut$)}
%     \\
%     \circeq \cuts \ ([\Rsr (\Rl \ (g, h'_1)), \dots, h'_m], \Rsl \ ([\ax_{D_i}], \cut\ (\Lsl \ ([\ax_{E_j}], \ax_{F_l}),g'')))
%     &
%     \\
%     &\hspace*{-7cm}\text{(by Lemma \ref{lem:left:rules:cut})}
%     \\
%     \circeq \cuts \ ([\Rsr (\Rl \ (g, h'_1)), \dots, h'_m],\Rsl\ ([\ax_{D_i}], \Lsl \ ([\ax_{E_j}], g'')))
%     &\hspace*{-7cm}\text{(by Lemma \ref{lem:left:rules:cut})}
%     \\
%     = \cuts\ ([h'_2,\dots,h'_m], (\cut \ (\Rsr \ (\Rl \ (g,h'_1)), \Rsl \ ([\ax_{D_i}], \Lsl \ ([\ax_{E_j}], g'')))))
%     &
%     \\
%     &\hspace*{-7cm}\text{(by (\ref{eq:cut:comm}))}
%     \\
%     \circeq \cuts\ ([h'_2,\dots,h'_m],\cut\ (\Rl \ (g, h'_1), \Rsl \ ([\ax_{E_j}], g'')))
%     &\hspace*{-7cm}\text{(by definition of $\cut$ and Lemma \ref{lem:left:rules:cut})}
%     \\
%     = \cuts\ ([h'_2,\dots,h'_m],\Lsl \ ([\Rl \ (g, h'_1), \ax_{E_2},\dots,\ax_{E_m}], g''))
%     &\hspace*{-7cm}\text{(by definition of $\cut$)}
%     \\
%     = \Lsl \ ([\Rl \ (g, h'_1), h'_2,\dots,h'_m], g'') 
%     &\hspace*{-7cm}\text{(by definition of $\cut$)} 
%     \\
%     = \Ll \ (\Rl \ (g,h'_1) , \Lsl \ ([h'_2,\dots,h'_m],g''))
%     &\hspace*{-7cm}\text{(by definition of $\Lsl$)}
%     \\
%     \circeq \Rl \ (g, \Ll \ (h'_1, \Lsl\ ([h'_2,\dots,h'_m],g'')))
%     &\hspace*{-7cm}\text{(by (\ref{eq:rl:ll:assoc}))}
%     \\
%     = \Rl \ (g, \Lsl \ ([h'_j], g'')) 
%     &\hspace*{-7cm}\text{(by definition of $\Lsl$)}
%     % &\hspace*{-10cm}
%   \end{array}
% \]
% The second case is:
% \[
%   \begin{array}{lr}
%     \cuts \ ([\Lsr \ (\Rl \ (g', h''_l)), h_1,\dots,h_n],\Lsr \ (\Rsl \ ([\ax_{D_i}], \Lsl \ ([\ax_{E_j}], \ax_{F_l}))))
%     &
%     \\
%     = \Lsr \ (\cuts \ ([\Lsr \ (\Rl \ (g', h''_l)), h_1,\dots,h_n], \Rsl \ ([\ax_{D_i}], \Lsl\ ([\ax_{E_j}], \ax_{F_l}))))
%     &
%     \\
%     & \hspace*{-7cm}\text{(by definition of $\cut$)}
%     \\
%     = \Lsr \ (\Rsl \ ([h_i], \cut \ (\Lsr\ (\Ll \ (g', h''_l)), \Lsl \ ([\ax_{E_j}], \ax_{F_l})))) 
%     \\
%     & \hspace*{-7cm}\text{(by definition of $\cut$)}
%     \\
%     = \Lsr \ (\Rsl \ ([h_i], \cuts \ ([\ax_{E_j}], \Ll \ (g',h''_l))))
%     & \hspace*{-7cm}\text{(by definition of $\cut$)}
%     \\
%     \circeq \Lsr \ (\Lsl \ ([h_i], \Ll \ (g', h''_l)))
%     &\hspace*{-7cm}\text{(by Lemma \ref{lem:left:rules:cut})}
%     \\
%     \circeq \Lsr \ (\Ll \ (\Rsl \ ([h_i], g'),h''_l))
%     &\hspace*{-7cm}\text{(by applying (\ref{eq:rl:ll:assoc}) $n$ times)}
%   \end{array}
% \]
%% ax annotated

%%Multi-intrp version for the previous case in well-def of L
%  $\Lsr \ (\Rsl \ ([\ax_{D_i}], \Lsl \ ([\ax_{E_j}], \ax_{F_l}))) : F_l \Ls [E_j], D_1, \dots, D_n \vd F_l \Ls ([D_i] \Rs E_1, E_2,\dots,E_m)$ 
   
%   \[
%       \scalebox{0.968}{$\begin{array}{rl}
%       \begin{array}{r}
%         \text{(interpolant quadruples}
%         \\
%         \text{of $f$, $f'$, and $f''$)}
%       \end{array}
%       &
%       \begin{array}{l}
%         (\langle \GD'_{01},\dots,\GD'_{0n}\rangle,[D_i] , g : D , \GD''_0 \vd A , [h_i : \GD'_{0i} \vd D_i])
%       \\[3pt]
%       (\langle \GD'_{11}, \dots,\GD'_{1m}\rangle,[E_j] , g' : E , \GD''_1 \vd A' , [h'_j : \GD'_{1j} \vd E_j])
%       \\[3pt]
%       (\langle \GL_1 , \GL_2,\dots,\GL_l\rangle,[F_k] , g'' : \GG , F , B' , \GO \vd C , [h''_l : \GL_l \vd F_l])
%       \end{array}
%       % & f' 
%       % & f''
%       % \\
%       % \hline
%       % D & E & F
%       % \\
%       % \hline
%       % g : D , \GD_1 \vd A & g' : \GG , E \vd A' & g'' : F , \GO_1 \vd B'
%       % \\
%       % \hline
%       % h : \GD_0 \vd D & h' : B , \GL \vd E & h'' : \GO_0 \vd F
%       \end{array}$}
%     \]
% Notice that $\GL_1 = B , \GL'_1$ for some $\GL'_1$.
%   \[
%       \begin{array}{lr}
%       \arraycolsep=20pt
%         \begin{array}{c}
%           \text{(for the top derivation)}
%           \\
%           D \Rarr (F \ot E)
%           \\
%           \Rl (h , \tl \ (\Rl \ (g' , g'')))
%           \\
%           \Rr \ (\Rl \ (g , (\tr \ (h'' , h'))))
%         \end{array}
%         &
%         \begin{array}{c}
%           \text{(for the bottom derivation)}
%           \\
%           (D \Rarr F) \ot E
%           \\
%           \tl \ (\Rl \ (g' , \Rl (h , g'')))
%           \\
%           \tr \ (\Rr \ (\Rl \ (g , h'')), h')
%         \end{array}
%       \end{array}
%     \]
\end{proof}


\section{Conclusion}
In this work, we have provided a detailed analysis of proof-relevant interpolation for the Lambek calculus (\L) and its product-free variant (\LPfree). 
We established their Maehara interpolation procedures (\MIP\ and \MmIP) are right inverses to the admissible cut rules, respectively and demonstrated that both \MIP\ and \MmIP\ are well-defined wrt\ $\circeq$, the equivalence relation of derivations.

A crucial finding is the discrepancy between non-associative (\NL) and associative Lambek calculi (\L\ and \LPfree).
In \NL, the equivalence of interpolant triples is strict, i.e.\ the interpolant formulae are exactly the same and the derivations are pairwise equivalent.
We resolved this by introducing a relaxed zig-zag equivalence relation on interpolant triples, defined by the existence of a derivation between interpolant formulae that equates derivations after cut.

The definitions and results we had in this work, including \MIP\ (\MmIP) being a right inverse of the admissible cut, definition of equivalence of interpolant triples (quadruples), and \MIP\ (\MmIP) being well-defined wrt.\ $\circeq$ can all be generalized to Lambek calculus with multiplicative unit and additive multiplication, disjunction and their units.

For the future, it will be interesting to see the computational behavior of equivalent interpolant triples. This would lead us to work in a term assignment calculus either in the sense of term assignment for sequent calculus \cite{Herbelin1995,Kanazawa2006} or Curien-Herbelin's $\lambda\mu\tilde{\mu} $ calculus \cite{Curien2000,Saurin2024}.
We would also like to study the well-definedness of interpolant triples in more permissive systems, e.g.\ sequent calculi with cuts \cite{Saurin2025} and complete calculi in \cite{Hetzl2024}.
It will also be interesting to have a general theory on well-definedness of families of calculi from the universal proof-theoretic perspective \cite{tabatabai2018,Tabatabai2025}.
% For the future, it will be interesting to see what should be the correct notion of equivalence on interpolant triples for the complete calculi in the sense of Hetzl and Jalali \cite{Hetzl2024}. 

% will the interpolant triples in complete calculi by \cite{Hetzl2024} are just collection of logically equivalent formulae?
% do modal logics also enjoy the well-defineness? 
% if we change to the term assignment of the calculus, what would it be? is there a good rewriting characterization?

\begin{credits}
\subsubsection*{\ackname} This work was supported by the Estonian Research Council grant PSG749. 

% \subsubsection{\discintname}
% It is now necessary to declare any competing interests or to specifically
% state that the authors have no competing interests. Please place the
% statement with a bold run-in heading in small font size beneath the
% (optional) acknowledgments\footnote{If EquinOCS, our proceedings submission
% system, is used, then the disclaimer can be provided directly in the system.},
% for example: The authors have no competing interests to declare that are
% relevant to the content of this article. Or: Author A has received research
% grants from Company W. Author B has received a speaker honorarium from
% Company X and owns stock in Company Y. Author C is a member of committee Z.
\end{credits}
%
% ---- Bibliography ----
%
% BibTeX users should specify bibliography style 'splncs04'.
% References will then be sorted and formatted in the correct style.
%
\bibliographystyle{splncs04}
\bibliography{ijcar}
%
\clearpage
\newpage
\appendix
\phantomsection
\section*{A. Formalization in Agda}
\addcontentsline{toc}{section}{A. Formalization in Agda}
As the readers might have noticed, the proof of Theorem \ref{thm:welldef:L} requires enormous amount of case distinction. It makes the proof error-prone and demanding. Therefore we formalize the $\Rarr,\ot$ fragment of \L\ in the Agda proof assistant as an experiment to test our calculation on pen and paper.

The formalization of the syntax of the $\Rarr,\ot$ fragment of \L\ is standard. We define the formulae, sequents as inductive types with the appropriate constructors for each connective and its corresponding left and right rules.
The equivalence relation of derivations $\circeq$ is defined as an inductive datatype including the constructors that makes $\circeq$ as an equivalence and congruence relation and all permutative conversions.
% The functions of cut admissibility and Maehara interpolation are constructed similarly as Veltri and Wan did for the nonassociative Lambek calculus \cite{VW2025Tableaux}. 
For Maehara interpolation, we first declare a record type \MIP:
% Therefore we formalize the $\Rarr,\ot$ fragment of \L\ and verify its cut admissibility, Maehara interpolation, proof-relevant interpolation and well-definedness of interpolation.
\[
\begin{array}{rl}
  \multicolumn{2}{l}{\record \:\:  \MIP ~ (\GG ~ \GD ~ \GL : \mf{Cxt}) ~ (C : \Fma) : \Set \:\: \where} \\
  \multicolumn{2}{l}{\quad \mf{constructor} ~ \mf{intrp}} \\
  \multicolumn{2}{l}{\quad \field} \\
  \;\; \quad D &: \Fma \\[2pt]
  \;\; \quad g &: \GG , D , \GL \vd C \\[2pt]
  \;\; \quad h &: \GD \vd D 
\end{array}
\]
Elements of the type $\MIP ~ \GG ~ \GD ~ \GL ~ C$ are triples consisting of a formula $D$ and two derivations $g$ and $h$, i.e.\ the interpolant triples.

Maehara interpolation is then witnessed by the construction of the following function $\mf{mip}$:
\[
\begin{array}{l}
\mathsf{mip} : (f : \GO \vd C) ~ (eq : \GO \equiv \GG \append \GD \append \GL) \to \MIP ~\GG ~ \GD ~ \GL ~C
\end{array}
\]
The function is constructed by pattern-matching on the derivation $f$.

The equivalence of interpolant triples is implemented in two steps.
The first step is to define an implication between two interpolant triples as a dependent product type:
\[
  \begin{array}{l}
  \mathsf\_{\Vdash}\_ : \forall \{\GG ~ \GD ~ \GD ~ C\} \to (n ~ n' : \MIP \GG ~ \GD ~ \GL ~C) \to \Set
  \\
  \mathsf\_{\Vdash}\_ ~ \{ \GG \} ~ (\mf{intrp} ~ D ~ g ~ h) ~ (\mf{intrp} ~ D' ~ g' ~ h')
  \\
  \hspace*{2cm}= \Sigma ~ (D \vd D') ~ \Gl ~ t ~ \to (g \circeq \cut ~ t ~ g') \times (\cut ~ h ~ t \circeq h') 
  \end{array}
\]
The elements of this dependent product are a derivation $t$ between interpolant formulae and the equivalence of the pairs of derivations cut with $t$.

Second, the equivalence relation of interpolant triples is implemented as an inductive type:
\[
\begin{array}{rl}
  \multicolumn{2}{l}{\data \:\:  \_{\sim}\_ ~ \{\GG ~ \GD ~ \GL~ C\} : \MIP~ \GG ~ \GD ~ \GL~ C\to \MIP~ \GG ~ \GD ~ \GL~ C \to \Set \:\: \where} \\
  \;\;\; \mf{refl} &: \{n : \MIP \GG ~ \GD ~ \GL ~C\} \to n \sim n \\
  \;\;\; \rcons &: \{n~n'~p : \MIP \GG ~ \GD ~ \GL ~C\} \to n \Vd n' \to n' \sim p \to n \sim p \\
  \;\;\; \lcons &: \{n~n'~p : \MIP \GG ~ \GD ~ \GL ~C\} \to n' \Vd n \to n' \sim p \to n \sim p
\end{array}
\]
The constructor $\mf{refl}$ means that any interpolant triple is equivalent to itself. 
The other two mean that for any three interpolant triples $n$, $n'$, and $p$, if $n' \sim p$, then we can update the equivalence to $n \sim p$ whenever we have a proof of $n \Vd n'$ or $n' \Vd n$.

Symmetry and transitivity of the relation $\_{\sim}\_$ are derivable so they are not included in the datatype.

The well-definedness of \MIP\ wrt.\ $\circeq$ is implemented as a record type:
\[
\begin{array}{rl}
  \multicolumn{2}{l}{\record \:\:  \MIP{\circeq} ~ (\GG ~ \GD ~ \GL : \mf{Cxt}) ~ (C : \Fma) ~ (n ~ n' : \MIP \GG ~ \GD ~ \GL ~ C) : \Set \:\: \where} \\
  \multicolumn{2}{l}{\quad \mf{constructor} ~ \mf{intrp{\circeq}}} \\
  \multicolumn{2}{l}{\quad \field} \\
  \;\; \quad eq &: n \sim n'
\end{array}
\]
The record type has one element, representing the equivalence of two interpolant triples.
Well-definedness of \MIP\ wrt.\ $\circeq$ is then witnessed by the construction of the following function $\mf{mip}{\circeq}$:
\[
\begin{array}{l}
\mathsf{mip}{\circeq} : \forall \GG ~ \GD ~ \GL ~\{\GO ~ C\} \to \{f ~ f' : \GO \vd C\} 
\\
\hspace*{0.4cm}\to (eq : \GO \equiv \GG \append \GD \append \GL) 
\to (p : f \circeq f') 
\\
\hspace*{0.4cm}\to \MIP{\circeq} ~\GG ~ \GD ~ \GL ~C ~(\mf{mip} ~ \GG ~ \GD ~ \GL ~f~ eq) ~ (\mf{mip} ~ \GG ~ \GD ~ \GL ~f'~ eq)
\end{array}
\]
The function is constructed by pattern-matching on $p$, the proof of equivalence of the derivations $f$ and $f'$. 

\underline{N. B.} 
The formalization postulates the admissible equations in Lemma \ref{lem:left:rules:cut} and congruence of $\cut$ wrt. $\circeq$. These equations are provable in Agda but we chose to postulate them and leave the proofs for the future.
We also include the multiplicative unit $\I$ and its left and right introduction rules to work with the sequents with lists of formulae as their antecedents. In this setting, we can smoothly prove \MIP\ following exactly the same strategy in the proof of Theorem \ref{thm:MIP} without dealing with non-empty list in Agda. The equations of derivations related to $\I$ are not included as well. The variable condition is also not considered in the formalization.

The code is available at \url{https://github.com/cswphilo/associative-Lambek/tree/main/code}.
\end{document}
